{"ast":null,"code":"import { regionRedirectEndpointMiddleware, regionRedirectEndpointMiddlewareOptions } from \"./region-redirect-endpoint-middleware\";\nexport function regionRedirectMiddleware(clientConfig) {\n  return (next, context) => async args => {\n    try {\n      return await next(args);\n    } catch (err) {\n      if (clientConfig.followRegionRedirects) {\n        var _err$$metadata, _err$$response;\n        const statusCode = err === null || err === void 0 || (_err$$metadata = err.$metadata) === null || _err$$metadata === void 0 ? void 0 : _err$$metadata.httpStatusCode;\n        const isHeadBucket = context.commandName === \"HeadBucketCommand\";\n        const bucketRegionHeader = err === null || err === void 0 || (_err$$response = err.$response) === null || _err$$response === void 0 || (_err$$response = _err$$response.headers) === null || _err$$response === void 0 ? void 0 : _err$$response[\"x-amz-bucket-region\"];\n        if (bucketRegionHeader) {\n          if (statusCode === 301 || statusCode === 400 && ((err === null || err === void 0 ? void 0 : err.name) === \"IllegalLocationConstraintException\" || isHeadBucket)) {\n            try {\n              var _context$logger;\n              const actualRegion = bucketRegionHeader;\n              (_context$logger = context.logger) === null || _context$logger === void 0 || _context$logger.debug(\"Redirecting from \".concat(await clientConfig.region(), \" to \").concat(actualRegion));\n              context.__s3RegionRedirect = actualRegion;\n            } catch (e) {\n              throw new Error(\"Region redirect failed: \" + e);\n            }\n            return next(args);\n          }\n        }\n      }\n      throw err;\n    }\n  };\n}\nexport const regionRedirectMiddlewareOptions = {\n  step: \"initialize\",\n  tags: [\"REGION_REDIRECT\", \"S3\"],\n  name: \"regionRedirectMiddleware\",\n  override: true\n};\nexport const getRegionRedirectMiddlewarePlugin = clientConfig => ({\n  applyToStack: clientStack => {\n    clientStack.add(regionRedirectMiddleware(clientConfig), regionRedirectMiddlewareOptions);\n    clientStack.addRelativeTo(regionRedirectEndpointMiddleware(clientConfig), regionRedirectEndpointMiddlewareOptions);\n  }\n});","map":{"version":3,"names":["regionRedirectEndpointMiddleware","regionRedirectEndpointMiddlewareOptions","regionRedirectMiddleware","clientConfig","next","context","args","err","followRegionRedirects","_err$$metadata","_err$$response","statusCode","$metadata","httpStatusCode","isHeadBucket","commandName","bucketRegionHeader","$response","headers","name","_context$logger","actualRegion","logger","debug","concat","region","__s3RegionRedirect","e","Error","regionRedirectMiddlewareOptions","step","tags","override","getRegionRedirectMiddlewarePlugin","applyToStack","clientStack","add","addRelativeTo"],"sources":["/home/rcts/Email-differ/Frontend/node_modules/@aws-sdk/middleware-sdk-s3/dist-es/region-redirect-middleware.js"],"sourcesContent":["import { regionRedirectEndpointMiddleware, regionRedirectEndpointMiddlewareOptions, } from \"./region-redirect-endpoint-middleware\";\nexport function regionRedirectMiddleware(clientConfig) {\n    return (next, context) => async (args) => {\n        try {\n            return await next(args);\n        }\n        catch (err) {\n            if (clientConfig.followRegionRedirects) {\n                const statusCode = err?.$metadata?.httpStatusCode;\n                const isHeadBucket = context.commandName === \"HeadBucketCommand\";\n                const bucketRegionHeader = err?.$response?.headers?.[\"x-amz-bucket-region\"];\n                if (bucketRegionHeader) {\n                    if (statusCode === 301 ||\n                        (statusCode === 400 && (err?.name === \"IllegalLocationConstraintException\" || isHeadBucket))) {\n                        try {\n                            const actualRegion = bucketRegionHeader;\n                            context.logger?.debug(`Redirecting from ${await clientConfig.region()} to ${actualRegion}`);\n                            context.__s3RegionRedirect = actualRegion;\n                        }\n                        catch (e) {\n                            throw new Error(\"Region redirect failed: \" + e);\n                        }\n                        return next(args);\n                    }\n                }\n            }\n            throw err;\n        }\n    };\n}\nexport const regionRedirectMiddlewareOptions = {\n    step: \"initialize\",\n    tags: [\"REGION_REDIRECT\", \"S3\"],\n    name: \"regionRedirectMiddleware\",\n    override: true,\n};\nexport const getRegionRedirectMiddlewarePlugin = (clientConfig) => ({\n    applyToStack: (clientStack) => {\n        clientStack.add(regionRedirectMiddleware(clientConfig), regionRedirectMiddlewareOptions);\n        clientStack.addRelativeTo(regionRedirectEndpointMiddleware(clientConfig), regionRedirectEndpointMiddlewareOptions);\n    },\n});\n"],"mappings":"AAAA,SAASA,gCAAgC,EAAEC,uCAAuC,QAAS,uCAAuC;AAClI,OAAO,SAASC,wBAAwBA,CAACC,YAAY,EAAE;EACnD,OAAO,CAACC,IAAI,EAAEC,OAAO,KAAK,MAAOC,IAAI,IAAK;IACtC,IAAI;MACA,OAAO,MAAMF,IAAI,CAACE,IAAI,CAAC;IAC3B,CAAC,CACD,OAAOC,GAAG,EAAE;MACR,IAAIJ,YAAY,CAACK,qBAAqB,EAAE;QAAA,IAAAC,cAAA,EAAAC,cAAA;QACpC,MAAMC,UAAU,GAAGJ,GAAG,aAAHA,GAAG,gBAAAE,cAAA,GAAHF,GAAG,CAAEK,SAAS,cAAAH,cAAA,uBAAdA,cAAA,CAAgBI,cAAc;QACjD,MAAMC,YAAY,GAAGT,OAAO,CAACU,WAAW,KAAK,mBAAmB;QAChE,MAAMC,kBAAkB,GAAGT,GAAG,aAAHA,GAAG,gBAAAG,cAAA,GAAHH,GAAG,CAAEU,SAAS,cAAAP,cAAA,gBAAAA,cAAA,GAAdA,cAAA,CAAgBQ,OAAO,cAAAR,cAAA,uBAAvBA,cAAA,CAA0B,qBAAqB,CAAC;QAC3E,IAAIM,kBAAkB,EAAE;UACpB,IAAIL,UAAU,KAAK,GAAG,IACjBA,UAAU,KAAK,GAAG,KAAK,CAAAJ,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEY,IAAI,MAAK,oCAAoC,IAAIL,YAAY,CAAE,EAAE;YAC9F,IAAI;cAAA,IAAAM,eAAA;cACA,MAAMC,YAAY,GAAGL,kBAAkB;cACvC,CAAAI,eAAA,GAAAf,OAAO,CAACiB,MAAM,cAAAF,eAAA,eAAdA,eAAA,CAAgBG,KAAK,qBAAAC,MAAA,CAAqB,MAAMrB,YAAY,CAACsB,MAAM,CAAC,CAAC,UAAAD,MAAA,CAAOH,YAAY,CAAE,CAAC;cAC3FhB,OAAO,CAACqB,kBAAkB,GAAGL,YAAY;YAC7C,CAAC,CACD,OAAOM,CAAC,EAAE;cACN,MAAM,IAAIC,KAAK,CAAC,0BAA0B,GAAGD,CAAC,CAAC;YACnD;YACA,OAAOvB,IAAI,CAACE,IAAI,CAAC;UACrB;QACJ;MACJ;MACA,MAAMC,GAAG;IACb;EACJ,CAAC;AACL;AACA,OAAO,MAAMsB,+BAA+B,GAAG;EAC3CC,IAAI,EAAE,YAAY;EAClBC,IAAI,EAAE,CAAC,iBAAiB,EAAE,IAAI,CAAC;EAC/BZ,IAAI,EAAE,0BAA0B;EAChCa,QAAQ,EAAE;AACd,CAAC;AACD,OAAO,MAAMC,iCAAiC,GAAI9B,YAAY,KAAM;EAChE+B,YAAY,EAAGC,WAAW,IAAK;IAC3BA,WAAW,CAACC,GAAG,CAAClC,wBAAwB,CAACC,YAAY,CAAC,EAAE0B,+BAA+B,CAAC;IACxFM,WAAW,CAACE,aAAa,CAACrC,gCAAgC,CAACG,YAAY,CAAC,EAAEF,uCAAuC,CAAC;EACtH;AACJ,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}