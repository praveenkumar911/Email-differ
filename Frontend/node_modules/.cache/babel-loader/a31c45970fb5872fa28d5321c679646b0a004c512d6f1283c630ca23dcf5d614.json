{"ast":null,"code":"import _objectSpread from\"/home/rcts/Email-differ/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState,useRef}from\"react\";import{useSearchParams}from\"react-router-dom\";import API,{validateToken,submitForm,deferForm,optOut}from\"../../api/apiService\";import{auth,signInWithPhoneNumber,RecaptchaVerifier}from\"../../firebase\";import{GithubAuthProvider,signInWithPopup,getAdditionalUserInfo,signOut}from\"firebase/auth\";import Swal from\"sweetalert2\";import{Box,Paper,Typography,TextField,Button,FormControl,InputLabel,Select,MenuItem,CircularProgress,Stack,Divider,Autocomplete}from\"@mui/material\";import logo1 from\"../../assets/badal_logo.png\";import logo2 from\"../../assets/c4gt_logo.png\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ORGANIZATIONS=[\"Self\",\"Government of India\",\"NITI Aayog\",\"Indian Institute of Technology\",\"Indian Institute of Science\",\"Microsoft India\",\"Google India\",\"TCS\",\"Infosys\",\"Wipro\",\"Other\"];const ORG_TYPE_MAPPINGS={\"Government of India\":\"Government\",\"NITI Aayog\":\"Government\",\"Indian Institute of Technology\":\"Academic\",\"Indian Institute of Science\":\"Academic\",\"Microsoft India\":\"Corporate\",\"Google India\":\"Corporate\",TCS:\"Corporate\",Infosys:\"Corporate\",Wipro:\"Corporate\",Self:\"Self\"};// âœ… Role List (matching SignUpPage)\nconst ROLES=[{value:\"R005\",label:\"Mentor\"},{value:\"R004\",label:\"Developer\"}];// âœ… Role codes to backend strings (consistent with SignUpPage)\n// eslint-disable-next-line no-unused-vars\nconst ROLE_MAP={R004:\"Student\",R005:\"Mentor\"};const GENDERS=[\"Male\",\"Female\",\"Other\",\"Prefer not to say\"];// âœ… Validation regex (available for future use)\n// eslint-disable-next-line no-unused-vars\nconst githubRegex=/^https:\\/\\/(www\\.)?github\\.com\\/[A-Za-z0-9_-]+\\/?$/;// eslint-disable-next-line no-unused-vars\nconst linkedinRegex=/^https:\\/\\/(www\\.)?linkedin\\.com\\/in\\/[A-Za-z0-9_-]+\\/?$/;const DISCORD_REDIRECT=\"https://pl-app.iiit.ac.in/rcts/account-setup/discord-callback\";const DISCORD_INVITE=\"https://discord.com/invite/rQEcfQfXgu\";// âœ… Generate OAuth state for CSRF protection\nconst generateOAuthState=()=>{return Math.random().toString(36).substring(2)+Date.now().toString(36);};const DISCORD_OAUTH=state=>\"https://discord.com/oauth2/authorize\"+\"?client_id=1450787791834447874\"+\"&redirect_uri=\"+encodeURIComponent(DISCORD_REDIRECT)+\"&response_type=code\"+\"&scope=identify%20guilds\"+\"&state=\"+encodeURIComponent(state);// LinkedIn OAuth removed: collecting URL via input field instead\nconst UpdateForm=()=>{const[searchParams]=useSearchParams();const token=searchParams.get(\"token\");const[formData,setFormData]=useState({fullName:\"\",email:\"\",phone:\"\",gender:\"\",organisation:\"\",orgType:\"\",role:\"\",githubId:\"\",githubUrl:\"\",discordId:\"\",linkedinId:\"\"});const[phoneVerification,setPhoneVerification]=useState({isVerified:false,showOtpInput:false,otp:\"\",isProcessing:false,firebaseToken:null// âœ… Store Firebase token for form submission\n});const[status,setStatus]=useState(\"loading\");const[errorMessage,setErrorMessage]=useState(\"\");const[interested,setInterested]=useState(null);const[optoutReason,setOptoutReason]=useState(\"\");const[optoutProcessing,setOptoutProcessing]=useState(false);const[timer,setTimer]=useState(0);const isDirtyRef=useRef(false);const[fadeOut,setFadeOut]=useState(false);const[countdown,setCountdown]=useState(5);const[timeRemaining,setTimeRemaining]=useState(600);// 10 minutes in seconds\nconst[showCustomOrg,setShowCustomOrg]=useState(false);// âœ… Add for custom org handling\nconst[isSubmitting,setIsSubmitting]=useState(false);// âœ… Prevent double submit\nconst recaptchaCleanedUp=useRef(false);// âœ… Track recaptcha cleanup\nconst recaptchaContainerIdRef=useRef(0);// âœ… Track unique container IDs\nconst recaptchaWidgetIdRef=useRef(null);// âœ… Track widget ID for proper cleanup\n// âœ… Reusable reCAPTCHA cleanup function\nconst cleanupRecaptcha=async function(){let aggressive=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;console.log(\"\\uD83E\\uDDF9 Cleaning up reCAPTCHA (aggressive: \".concat(aggressive,\")...\"));// Step 1: Clear Firebase RecaptchaVerifier\nif(window.recaptchaVerifier){try{await window.recaptchaVerifier.clear();console.log('âœ“ Cleared recaptchaVerifier');}catch(e){console.warn('Failed to clear recaptchaVerifier:',e);}delete window.recaptchaVerifier;window.recaptchaVerifier=null;}// Step 2: Reset ALL grecaptcha widgets aggressively\nif(window.grecaptcha&&window.grecaptcha.reset){try{// Try to reset by widget ID first\nif(recaptchaWidgetIdRef.current!==null){try{window.grecaptcha.reset(recaptchaWidgetIdRef.current);console.log(\"\\u2713 Reset grecaptcha widget \".concat(recaptchaWidgetIdRef.current));}catch(e){console.warn('Failed to reset specific widget:',e);}}// Always try to reset without ID (resets all widgets)\ntry{window.grecaptcha.reset();console.log('âœ“ Reset all grecaptcha widgets');}catch(e){console.warn('Failed to reset all widgets:',e);}}catch(e){console.warn('Failed to reset grecaptcha:',e);}}recaptchaWidgetIdRef.current=null;// Step 3: Completely remove and recreate DOM container\nconst container=document.getElementById(\"recaptcha-container-update\");if(container){// Remove ALL content and event listeners\ncontainer.innerHTML=\"\";container.textContent=\"\";// Remove all data attributes that grecaptcha might have added\nArray.from(container.attributes).forEach(attr=>{if(attr.name.startsWith('data-')){container.removeAttribute(attr.name);}});console.log('âœ“ Cleared DOM container completely');}recaptchaCleanedUp.current=true;};// Form validation - check if all required fields are filled\nconst isFormComplete=()=>{var _formData$fullName,_formData$email,_formData$phone;// âœ… Check if submission is in progress\nif(isSubmitting)return false;// âœ… Handle organisation as string or ensure it exists\nconst orgValue=typeof formData.organisation==='string'?formData.organisation.trim():formData.organisation||\"\";const requiredFieldsFilled=((_formData$fullName=formData.fullName)===null||_formData$fullName===void 0?void 0:_formData$fullName.trim())!==\"\"&&((_formData$email=formData.email)===null||_formData$email===void 0?void 0:_formData$email.trim())!==\"\"&&((_formData$phone=formData.phone)===null||_formData$phone===void 0?void 0:_formData$phone.trim())!==\"\"&&formData.gender!==\"\"&&orgValue!==\"\"&&formData.orgType!==\"\"&&formData.role!==\"\";const socialVerified=githubStatus.verified&&discordVerified;const phoneVerified=phoneVerification.isVerified;return requiredFieldsFilled&&socialVerified&&phoneVerified;};// OAuth verification states\nconst[githubStatus,setGithubStatus]=useState({verifying:false,verified:false,username:\"\",avatar:\"\",// âœ… Store avatar URL\nerror:\"\"});const[discordVerified,setDiscordVerified]=useState(sessionStorage.getItem(\"discordVerified\")===\"true\");const[discordNotMember,setDiscordNotMember]=useState(sessionStorage.getItem(\"discordNotMember\")===\"true\");const[discordStatus,setDiscordStatus]=useState({verifying:false});const[oauthInProgress,setOauthInProgress]=useState(false);// ðŸ”” SweetAlert helper\nconst showAlert=function(text){let icon=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"info\";return Swal.fire({text,icon,confirmButtonColor:\"#1E4DD8\"});};// âœ… Restore UpdateForm context when returning from OAuth\nuseEffect(()=>{const isReturningFromOAuth=sessionStorage.getItem(\"isNavigating\");if(isReturningFromOAuth){const savedFormData=sessionStorage.getItem(\"updateFormData\");const savedToken=sessionStorage.getItem(\"updateFormToken\");if(savedFormData){try{const parsedData=JSON.parse(savedFormData);setFormData(prev=>_objectSpread(_objectSpread({},prev),parsedData));}catch(e){console.error(\"Failed to restore form data:\",e);}}// âœ… Restore phone verification state\nconst savedPhoneVerification=sessionStorage.getItem(\"phoneVerificationState\");if(savedPhoneVerification){try{const parsedPhoneData=JSON.parse(savedPhoneVerification);setPhoneVerification(prev=>_objectSpread(_objectSpread({},prev),{},{isVerified:parsedPhoneData.isVerified,firebaseToken:parsedPhoneData.firebaseToken,showOtpInput:false// Hide OTP input since already verified\n}));console.log(\"âœ… Restored phone verification state from sessionStorage\");}catch(e){console.error(\"Failed to restore phone verification:\",e);}}// Clear OAuth in progress flag on backend\nif(savedToken){API.post('/form/oauth-status',{token:savedToken,inProgress:false}).catch(err=>console.error(\"Failed to clear OAuth flag:\",err));}sessionStorage.removeItem(\"isNavigating\");sessionStorage.removeItem(\"updateFormData\");sessionStorage.removeItem(\"updateFormToken\");setOauthInProgress(false);}},[]);// âœ… Token validation\nuseEffect(()=>{const activateAndValidate=async()=>{if(!token){setStatus(\"invalid\");setErrorMessage(\"No token provided\");return;}try{// âœ… Activate token and get activatedAt timestamp\nconst activateRes=await API.post(\"/form/activate\",{token});const res=await validateToken(token);if(res.data.valid){var _partialRes$data,_activateRes$data;setStatus(\"valid\");const partialRes=await API.get(\"/form/partial/\".concat(token));if((_partialRes$data=partialRes.data)!==null&&_partialRes$data!==void 0&&_partialRes$data.data){setFormData(prev=>_objectSpread(_objectSpread({},prev),partialRes.data.data));}// âœ… Calculate time remaining from backend activatedAt timestamp\nif((_activateRes$data=activateRes.data)!==null&&_activateRes$data!==void 0&&_activateRes$data.activatedAt){const activatedTime=new Date(activateRes.data.activatedAt).getTime();const now=Date.now();const elapsed=Math.floor((now-activatedTime)/1000);// seconds elapsed\nconst remaining=Math.max(0,600-elapsed);// 10 minutes = 600 seconds\nsetTimeRemaining(remaining);}// â° Token expires after 7 days (matches backend expiry window)\nconst timer=setTimeout(()=>{setStatus(\"expired\");alert(\"This link has expired. Please check your email for a new update link.\");},7*24*60*60*1000);// 7 days\nreturn()=>clearTimeout(timer);}else{setStatus(\"invalid\");setErrorMessage(res.data.message||\"Invalid token\");}}catch(err){var _err$response,_err$response$data;const errorMsg=((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||\"Failed to load form\";// âœ… Check if form was already submitted\nif(errorMsg===\"Form already submitted\"){setStatus(\"submitted\");}else{setStatus(\"invalid\");setErrorMessage(errorMsg);}}};activateAndValidate();},[token]);// âœ… Clean up reCAPTCHA on component unmount\nuseEffect(()=>{return()=>{cleanupRecaptcha(true);// Aggressive cleanup on unmount\n};},[]);// âœ… Auto-save every 5 seconds (only if form data changed)\nuseEffect(()=>{if(status!==\"valid\")return;const timer=setInterval(async()=>{// âœ… Only save if form data has changed\nif(!isDirtyRef.current)return;try{await API.post(\"/form/save-partial\",{token,data:formData});isDirtyRef.current=false;// âœ… Reset dirty flag after successful save\n}catch(_unused){}},5000);return()=>clearInterval(timer);},[formData,status,token]);// â± Resend timer\nuseEffect(()=>{if(timer>0){const interval=setInterval(()=>setTimer(t=>t-1),1000);return()=>clearInterval(interval);}},[timer]);// Restore GitHub verification from sessionStorage\nuseEffect(()=>{const verified=sessionStorage.getItem(\"githubVerified\")===\"true\";const username=sessionStorage.getItem(\"githubUsername\");const url=sessionStorage.getItem(\"githubUrl\");if(verified&&username&&url){setGithubStatus({verifying:false,verified:true,username,error:\"\"});setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{githubUrl:url}));}},[]);// Restore Discord verification from sessionStorage\nuseEffect(()=>{const verified=sessionStorage.getItem(\"discordVerified\")===\"true\";const notMember=sessionStorage.getItem(\"discordNotMember\")===\"true\";setDiscordVerified(verified);setDiscordNotMember(notMember);if(verified){const discordUsername=sessionStorage.getItem(\"discordUsername\");if(discordUsername){// Use username (display name like \"user#1234\"), not numeric ID\nsetFormData(prev=>_objectSpread(_objectSpread({},prev),{},{discordId:discordUsername}));}}},[]);// âœ… Auto-close tab + countdown when deferred\nuseEffect(()=>{if(status===\"deferred\"){const interval=setInterval(()=>{setCountdown(prev=>{if(prev<=1){window.close();// auto-close after countdown\nclearInterval(interval);return 0;}return prev-1;});},1000);return()=>clearInterval(interval);}},[status]);// Restore GitHub verification from sessionStorage\nuseEffect(()=>{const verified=sessionStorage.getItem(\"githubVerified\")===\"true\";const username=sessionStorage.getItem(\"githubUsername\");const url=sessionStorage.getItem(\"githubUrl\");if(verified&&username&&url){setGithubStatus({verifying:false,verified:true,username,error:\"\"});setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{githubUrl:url}));}},[]);// âœ… Restore phone verification from sessionStorage on mount\nuseEffect(()=>{const savedPhoneVerification=sessionStorage.getItem(\"phoneVerificationState\");if(savedPhoneVerification){try{const parsedPhoneData=JSON.parse(savedPhoneVerification);// Check if verification is still recent (within 1 hour)\nconst verifiedAt=new Date(parsedPhoneData.verifiedAt);const now=new Date();const ageInMs=now-verifiedAt;const oneHourInMs=60*60*1000;if(ageInMs<oneHourInMs){setPhoneVerification(prev=>_objectSpread(_objectSpread({},prev),{},{isVerified:parsedPhoneData.isVerified,firebaseToken:parsedPhoneData.firebaseToken,showOtpInput:false}));console.log(\"âœ… Restored phone verification from sessionStorage on mount\");}else{// Expired - clear it\nsessionStorage.removeItem(\"phoneVerificationState\");console.log(\"âš ï¸ Phone verification expired, cleared from sessionStorage\");}}catch(e){console.error(\"Failed to restore phone verification on mount:\",e);}}},[]);// âœ… 10-minute countdown timer with auto-expiry\nuseEffect(()=>{if(status===\"valid\"&&timeRemaining>0){const countdownInterval=setInterval(()=>{setTimeRemaining(prev=>{if(prev<=1){clearInterval(countdownInterval);setStatus(\"expired\");Swal.fire({icon:\"warning\",title:\"Token Expired\",html:\"\\n                <p>Your form session has expired after 10 minutes.</p>\\n                <p><strong>What happens next?</strong></p>\\n                <ul style=\\\"text-align: left; margin: 10px 20px;\\\">\\n                  <li>This form will be automatically closed</li>\\n                  <li>You will receive a new reminder email within 24 hours</li>\\n                  <li>You can complete the form using the new link</li>\\n                </ul>\\n              \",confirmButtonColor:\"#1E4DD8\",confirmButtonText:\"OK\"});return 0;}return prev-1;});},1000);return()=>clearInterval(countdownInterval);}},[status,timeRemaining]);// âœ… Verify GitHub\nconst handleVerifyGithub=async()=>{setGithubStatus({verifying:true,verified:false,username:\"\",avatar:\"\",error:\"\"});try{var _info$profile;const provider=new GithubAuthProvider();const result=await signInWithPopup(auth,provider);const info=getAdditionalUserInfo(result);const githubUsername=info===null||info===void 0?void 0:info.username;const githubAvatar=(info===null||info===void 0?void 0:(_info$profile=info.profile)===null||_info$profile===void 0?void 0:_info$profile.avatar_url)||\"\";if(!githubUsername)throw new Error(\"Unable to retrieve GitHub username\");const verifiedUrl=\"https://github.com/\".concat(githubUsername);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{githubUrl:verifiedUrl}));// âœ… Store in sessionStorage for persistence\nsessionStorage.setItem(\"githubVerified\",\"true\");sessionStorage.setItem(\"githubUsername\",githubUsername);sessionStorage.setItem(\"githubUrl\",verifiedUrl);sessionStorage.setItem(\"githubAvatar\",githubAvatar);setGithubStatus({verifying:false,verified:true,username:githubUsername,avatar:githubAvatar,error:\"\"});await signOut(auth);showAlert(\"GitHub verified successfully!\",\"success\");}catch(err){var _err$message,_err$message2;console.error(\"GitHub verify error:\",err);// âœ… Handle different error types\nlet errorMsg=\"GitHub verification failed. Please try again.\";if(err.code===\"auth/popup-closed-by-user\"){errorMsg=\"Verification cancelled. Please try again.\";}else if(err.code===\"auth/popup-blocked\"){errorMsg=\"Popup was blocked by your browser. Please allow popups for this site and try again.\";}else if(err.code===\"auth/cancelled-popup-request\"){errorMsg=\"Verification cancelled. Please try again.\";}else if((_err$message=err.message)!==null&&_err$message!==void 0&&_err$message.includes(\"rate\")||(_err$message2=err.message)!==null&&_err$message2!==void 0&&_err$message2.includes(\"limit\")){errorMsg=\"Too many verification attempts. Please wait a few minutes and try again.\";}setGithubStatus({verifying:false,verified:false,username:\"\",avatar:\"\",error:errorMsg});if(err.code!==\"auth/popup-closed-by-user\"){showAlert(errorMsg,\"error\");}}};// âœ… Verify Discord (redirect-based)\nconst handleVerifyDiscord=async()=>{try{// âœ… Set verifying state\nsetDiscordStatus({verifying:true});// âœ… Generate OAuth state for CSRF protection\nconst state=generateOAuthState();sessionStorage.setItem(\"discordOAuthState\",state);// âœ… Clear stale member flag before starting\nsessionStorage.removeItem(\"discordNotMember\");setDiscordNotMember(false);// Mark OAuth as in progress to extend token expiry\nawait API.post('/form/oauth-status',{token,inProgress:true});// Save form data and token before redirect\nsessionStorage.setItem(\"updateFormData\",JSON.stringify(formData));sessionStorage.setItem(\"updateFormToken\",token);// âœ… Save phone verification state if verified\nif(phoneVerification.isVerified&&phoneVerification.firebaseToken){sessionStorage.setItem(\"phoneVerificationState\",JSON.stringify({isVerified:true,firebaseToken:phoneVerification.firebaseToken,verifiedAt:new Date().toISOString()}));}sessionStorage.setItem(\"oauthReturnPath\",\"/update-form?token=\".concat(token));setOauthInProgress(true);// âœ… Show loading state briefly before redirect\nshowAlert(\"Redirecting to Discord...\",\"info\");// Redirect to Discord OAuth with state\nsetTimeout(()=>{window.location.href=DISCORD_OAUTH(state);},500);}catch(err){console.error(\"Failed to mark OAuth in progress:\",err);setOauthInProgress(false);// âœ… Clear flag to allow retry\nsetDiscordStatus({verifying:false});// âœ… Reset verifying state\nshowAlert(\"Failed to start Discord verification. Please try again.\",\"error\");}};// âœ… Handle organization change (like SignUpPage)\nconst handleOrgChange=(event,value)=>{isDirtyRef.current=true;if(!value){setShowCustomOrg(false);setFormData(_objectSpread(_objectSpread({},formData),{},{organisation:\"\",orgType:\"\"}));return;}if(value===\"Other\"){setShowCustomOrg(true);setFormData(_objectSpread(_objectSpread({},formData),{},{organisation:\"\",orgType:\"\"}));}else{setShowCustomOrg(false);const orgType=ORG_TYPE_MAPPINGS[value]||\"\";setFormData(_objectSpread(_objectSpread({},formData),{},{organisation:value,orgType}));}};// âœ… Handle changes\nconst handleChange=e=>{isDirtyRef.current=true;const{name,value}=e.target;// âœ… Numeric-only phone input (10 digits)\nif(name===\"phone\"){const onlyNums=value.replace(/\\D/g,\"\");if(onlyNums.length<=10){setFormData(_objectSpread(_objectSpread({},formData),{},{phone:onlyNums}));// Reset phone verification when phone changes\nsetPhoneVerification({isVerified:false,showOtpInput:false,otp:\"\",isProcessing:false,firebaseToken:null});// âœ… Clear from sessionStorage when phone changes\nsessionStorage.removeItem(\"phoneVerificationState\");// âœ… Clean up reCAPTCHA when phone changes\ncleanupRecaptcha(false);}return;}setFormData(_objectSpread(_objectSpread({},formData),{},{[name]:value}));};// âœ… Request OTP\nconst handleRequestOtp=async()=>{var _formData$phone2;const phoneNumber=(_formData$phone2=formData.phone)===null||_formData$phone2===void 0?void 0:_formData$phone2.trim();if(!phoneNumber||phoneNumber.length!==10){return showAlert(\"Please enter a valid 10-digit phone number.\",\"warning\");}if(timer>0)return showAlert(\"Please wait \".concat(timer,\"s before resending OTP.\"),\"info\");// âœ… Prevent multiple rapid clicks\nif(phoneVerification.isProcessing){console.log('âš ï¸ OTP request already in progress');return;}setPhoneVerification(p=>_objectSpread(_objectSpread({},p),{},{isProcessing:true}));try{// âœ… Use aggressive cleanup utility\nawait cleanupRecaptcha(true);// Generate unique container ID\nrecaptchaContainerIdRef.current+=1;const uniqueContainerId=\"recaptcha-container-update-\".concat(recaptchaContainerIdRef.current);// Recreate container\nconst container=document.getElementById(\"recaptcha-container-update\");if(!container){console.error('âŒ recaptcha-container-update not found in DOM');throw new Error('reCAPTCHA container not found');}// Create fresh inner div\nconst newDiv=document.createElement('div');newDiv.id=uniqueContainerId;newDiv.className='recaptcha-inner';container.appendChild(newDiv);// Wait for DOM to be ready\nawait new Promise(resolve=>setTimeout(resolve,200));// Verify container exists\nconst targetContainer=document.getElementById(uniqueContainerId);if(!targetContainer){throw new Error(\"Container \".concat(uniqueContainerId,\" not found after creation\"));}console.log(\"\\u2713 Created fresh container: \".concat(uniqueContainerId));// Step 6: Create new RecaptchaVerifier with unique container\nconsole.log('ðŸ”§ Creating new RecaptchaVerifier...');window.recaptchaVerifier=new RecaptchaVerifier(auth,uniqueContainerId,{size:\"invisible\",callback:()=>console.log(\"reCAPTCHA solved\"),\"expired-callback\":()=>console.warn(\"reCAPTCHA expired\")});// Step 7: Render and store widget ID (with additional error handling)\nlet widgetId;try{widgetId=await window.recaptchaVerifier.render();recaptchaWidgetIdRef.current=widgetId;console.log(\"\\u2705 reCAPTCHA rendered successfully in \".concat(uniqueContainerId,\" (widget ID: \").concat(widgetId,\")\"));}catch(renderError){// If render still fails, try one more time with complete reset\nconsole.warn('âš ï¸ First render attempt failed, trying complete reset...',renderError);// Nuclear option: reload grecaptcha script\nif(window.grecaptcha){delete window.grecaptcha;}// Wait a bit longer\nawait new Promise(resolve=>setTimeout(resolve,500));// Try to render again\nwidgetId=await window.recaptchaVerifier.render();recaptchaWidgetIdRef.current=widgetId;console.log(\"\\u2705 reCAPTCHA rendered successfully on retry (widget ID: \".concat(widgetId,\")\"));}const e164Phone=\"+91\".concat(phoneNumber);const confirmationResult=await signInWithPhoneNumber(auth,e164Phone,window.recaptchaVerifier);window.confirmationResult=confirmationResult;showAlert(\"OTP sent successfully to your phone!\",\"success\");setPhoneVerification({showOtpInput:true,isVerified:false,otp:\"\",isProcessing:false});setTimer(30);// cooldown\nrecaptchaCleanedUp.current=false;}catch(err){var _err$message3;console.error(\"OTP send error:\",err);// âœ… Provide user-friendly error messages\nlet errorMsg=\"Failed to send OTP. Please try again.\";if(err.code===\"auth/too-many-requests\"){errorMsg=\"Too many attempts. Please try again later.\";}else if(err.code===\"auth/invalid-phone-number\"){errorMsg=\"Invalid phone number format.\";}else if((_err$message3=err.message)!==null&&_err$message3!==void 0&&_err$message3.includes(\"reCAPTCHA\")){errorMsg=err.message;}showAlert(errorMsg,\"error\");// âœ… Clean up on error\nawait cleanupRecaptcha(true);setPhoneVerification(p=>_objectSpread(_objectSpread({},p),{},{isProcessing:false}));}};// âœ… Verify OTP\nconst handleVerifyOtp=async()=>{if(!phoneVerification.otp.trim()||phoneVerification.otp.length!==6){return showAlert(\"Please enter a valid 6-digit OTP.\",\"warning\");}setPhoneVerification(p=>_objectSpread(_objectSpread({},p),{},{isProcessing:true}));try{const result=await window.confirmationResult.confirm(phoneVerification.otp);const user=result.user;const firebaseToken=await user.getIdToken();// âœ… Send phone with +91 prefix\nawait API.post(\"/form/verify-phone\",{token,phone:formData.phone,// Backend will normalize\nfirebaseToken});showAlert(\"Phone verified successfully!\",\"success\");const verifiedState=_objectSpread(_objectSpread({},phoneVerification),{},{isVerified:true,isProcessing:false,firebaseToken// âœ… Store token for form submission\n});setPhoneVerification(verifiedState);// âœ… Save to sessionStorage to persist across OAuth redirects\nsessionStorage.setItem(\"phoneVerificationState\",JSON.stringify({isVerified:true,firebaseToken,verifiedAt:new Date().toISOString()}));// âœ… Clean up recaptcha after successful verification\nawait cleanupRecaptcha(false);}catch(err){console.error(\"OTP verification failed:\",err);// âœ… User-friendly error messages\nlet errorMsg=\"Invalid or expired OTP. Please try again.\";if(err.code===\"auth/invalid-verification-code\"){errorMsg=\"Invalid OTP code. Please check and try again.\";}else if(err.code===\"auth/code-expired\"){errorMsg=\"OTP has expired. Please request a new one.\";}showAlert(errorMsg,\"error\");// âœ… Clear verifier to allow retry\nawait cleanupRecaptcha(false);setPhoneVerification(p=>_objectSpread(_objectSpread({},p),{},{isProcessing:false}));}};// âœ… Submit\nconst handleSubmit=async e=>{var _formData$fullName2,_formData$email2,_formData$organisatio;e.preventDefault();// âœ… Prevent double submission\nif(isSubmitting){return;}// âœ… Detailed validation\nif(!((_formData$fullName2=formData.fullName)!==null&&_formData$fullName2!==void 0&&_formData$fullName2.trim())){return showAlert(\"Please enter your full name.\",\"warning\");}if(!formData.phone||formData.phone.length!==10){return showAlert(\"Please enter a valid 10-digit phone number.\",\"warning\");}if(!((_formData$email2=formData.email)!==null&&_formData$email2!==void 0&&_formData$email2.trim())||!formData.email.includes(\"@\")){return showAlert(\"Please enter a valid email address.\",\"warning\");}if(!formData.gender){return showAlert(\"Please select your gender.\",\"warning\");}if(!((_formData$organisatio=formData.organisation)!==null&&_formData$organisatio!==void 0&&_formData$organisatio.trim())){return showAlert(\"Please select or enter your organisation.\",\"warning\");}if(!formData.role){return showAlert(\"Please select your role.\",\"warning\");}if(!githubStatus.verified){return showAlert(\"Please verify your GitHub account before submitting.\",\"warning\");}if(!discordVerified){return showAlert(\"Please verify your Discord account before submitting.\",\"warning\");}if(!phoneVerification.isVerified){return showAlert(\"Please verify your phone number before submitting.\",\"warning\");}const confirm=await Swal.fire({title:\"Confirm Submission?\",text:\"Please review your information before submitting.\",icon:\"question\",showCancelButton:true,confirmButtonText:\"Submit\",confirmButtonColor:\"#1E4DD8\"});if(!confirm.isConfirmed)return;// âœ… Prevent multiple submissions\nif(isSubmitting){console.log('âš ï¸ Submission already in progress');return;}setIsSubmitting(true);try{var _formData$fullName3,_formData$email3,_formData$organisatio2,_formData$githubUrl,_formData$githubId,_formData$discordId,_formData$linkedinId,_finalData$token,_finalData$firebaseTo;isDirtyRef.current=false;// âœ… Get verified social media data from sessionStorage\nconst githubUsername=sessionStorage.getItem(\"githubUsername\")||\"\";const githubUrl=sessionStorage.getItem(\"githubUrl\")||\"\";const discordId=sessionStorage.getItem(\"discordId\")||\"\";const discordUsername=sessionStorage.getItem(\"discordUsername\")||\"\";const cleanedData={fullName:(_formData$fullName3=formData.fullName)===null||_formData$fullName3===void 0?void 0:_formData$fullName3.trim(),email:(_formData$email3=formData.email)===null||_formData$email3===void 0?void 0:_formData$email3.trim(),phone:formData.phone,gender:formData.gender,organisation:(_formData$organisatio2=formData.organisation)===null||_formData$organisatio2===void 0?void 0:_formData$organisatio2.trim(),orgType:formData.orgType,role:formData.role,githubUrl:githubUrl||((_formData$githubUrl=formData.githubUrl)===null||_formData$githubUrl===void 0?void 0:_formData$githubUrl.trim())||null,githubId:githubUsername||((_formData$githubId=formData.githubId)===null||_formData$githubId===void 0?void 0:_formData$githubId.trim())||null,discordId:discordId||((_formData$discordId=formData.discordId)===null||_formData$discordId===void 0?void 0:_formData$discordId.trim())||null,linkedinId:((_formData$linkedinId=formData.linkedinId)===null||_formData$linkedinId===void 0?void 0:_formData$linkedinId.trim())||null,token,firebaseToken:phoneVerification.firebaseToken// âœ… Include Firebase token\n};// âœ… Remove null/empty fields (but keep token and firebaseToken)\nconst finalData={};Object.keys(cleanedData).forEach(key=>{// Always include token and firebaseToken\nif(key==='token'||key==='firebaseToken'){finalData[key]=cleanedData[key];}else if(cleanedData[key]!==null&&cleanedData[key]!==\"\"){finalData[key]=cleanedData[key];}});// âœ… Debug logging\nconsole.log('ðŸ“¤ Submitting form with keys:',Object.keys(finalData));console.log('ðŸ“¤ Token:',((_finalData$token=finalData.token)===null||_finalData$token===void 0?void 0:_finalData$token.substring(0,10))+'...');console.log('ðŸ“¤ Firebase token:',((_finalData$firebaseTo=finalData.firebaseToken)===null||_finalData$firebaseTo===void 0?void 0:_finalData$firebaseTo.substring(0,20))+'...');await submitForm(finalData);await API.delete(\"/form/partial/\".concat(token));sessionStorage.removeItem(\"updateFormData\");sessionStorage.removeItem(\"updateFormToken\");sessionStorage.removeItem(\"oauthReturnPath\");sessionStorage.removeItem(\"phoneVerificationState\");// âœ… Clear phone verification\nsessionStorage.removeItem(\"githubVerified\");sessionStorage.removeItem(\"githubUsername\");sessionStorage.removeItem(\"githubUrl\");sessionStorage.removeItem(\"githubAvatar\");sessionStorage.removeItem(\"discordVerified\");sessionStorage.removeItem(\"discordUsername\");sessionStorage.removeItem(\"discordId\");sessionStorage.removeItem(\"discordAvatarUrl\");sessionStorage.removeItem(\"discordNotMember\");sessionStorage.removeItem(\"discordOAuthState\");setStatus(\"submitted\");showAlert(\"Form submitted successfully!\",\"success\");}catch(err){var _err$response2,_err$response3,_err$response4,_err$response4$data,_err$response5;console.error(\"Submission error:\",err);console.error(\"Error response:\",(_err$response2=err.response)===null||_err$response2===void 0?void 0:_err$response2.data);console.error(\"Error status:\",(_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.status);const errorMessage=((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.message)||\"Submission failed. Please try again.\";// âœ… Handle 409 Conflict (user already exists)\nif(((_err$response5=err.response)===null||_err$response5===void 0?void 0:_err$response5.status)===409){var _err$response6,_err$response6$data;const userId=(_err$response6=err.response)===null||_err$response6===void 0?void 0:(_err$response6$data=_err$response6.data)===null||_err$response6$data===void 0?void 0:_err$response6$data.userId;showAlert(\"This account already exists\".concat(userId?\" (User ID: \".concat(userId,\")\"):'',\". \").concat(errorMessage),\"error\");return;}// âœ… If phone conflict error, reset phone verification so user can change number\nif(errorMessage.includes(\"phone number\")||errorMessage.includes(\"already registered\")){setPhoneVerification({isVerified:false,showOtpInput:false,otp:\"\",isProcessing:false,firebaseToken:null});showAlert(\"This phone number is already registered with a different account. Please use a different number or verify with the correct account.\",\"error\");}else{showAlert(errorMessage,\"error\");}}finally{setIsSubmitting(false);}};// âœ… Defer\n// âœ… Defer (with confirmation + smooth exit)\nconst handleDefer=async()=>{const confirmDefer=window.confirm(\"Are you sure you want to defer filling this form?\\nYouâ€™ll receive a reminder email later.\");if(!confirmDefer)return;// user chose No â€” stay on form\ntry{await deferForm({token});setFadeOut(true);setTimeout(()=>setStatus(\"deferred\"),600);// fade-out animation time\n}catch(err){var _err$response7,_err$response7$data;showAlert(((_err$response7=err.response)===null||_err$response7===void 0?void 0:(_err$response7$data=_err$response7.data)===null||_err$response7$data===void 0?void 0:_err$response7$data.message)||\"Failed to defer form.\",\"error\");}};// âœ… Opt-out\nconst handleOptOut=async()=>{const confirm=await Swal.fire({title:\"Confirm Opt-Out?\",text:\"You wonâ€™t receive future communications.\",icon:\"warning\",showCancelButton:true,confirmButtonText:\"Opt Out\",confirmButtonColor:\"#d33\"});if(!confirm.isConfirmed)return;setOptoutProcessing(true);try{await optOut({token,reason:optoutReason});setOptoutProcessing(false);setInterested(\"no\");setStatus(\"deferred\");showAlert(\"You have been opted out successfully.\",\"success\");}catch(err){var _err$response8,_err$response8$data;setOptoutProcessing(false);showAlert(((_err$response8=err.response)===null||_err$response8===void 0?void 0:(_err$response8$data=_err$response8.data)===null||_err$response8$data===void 0?void 0:_err$response8$data.message)||\"Failed to opt out.\",\"error\");}};// âœ… Conditional Views\nif(status===\"loading\")return/*#__PURE__*/_jsx(Typography,{align:\"center\",children:\"Loading form...\"});if(status===\"invalid\")return/*#__PURE__*/_jsx(Box,{sx:{minHeight:\"100vh\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",bgcolor:\"#f8f9fa\",p:2},children:/*#__PURE__*/_jsxs(Paper,{sx:{width:\"100%\",maxWidth:480,p:4,borderRadius:3,boxShadow:4,textAlign:\"center\"},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",color:\"error\",fontWeight:\"bold\",gutterBottom:true,children:\"\\u274C Invalid or Expired Link\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{mb:2},children:errorMessage||\"This link is no longer valid.\"}),/*#__PURE__*/_jsx(Divider,{sx:{my:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",fontWeight:\"bold\",gutterBottom:true,children:\"What happened?\"}),/*#__PURE__*/_jsxs(Box,{sx:{textAlign:\"left\",mx:3,my:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\uD83D\\uDD17 The link may have already been used\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\u23F0 The link may have expired (7 days validity)\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\u2705 You may have already submitted the form\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"\\uD83D\\uDEAB You may have opted out or deferred\"})]}),/*#__PURE__*/_jsx(Divider,{sx:{my:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",fontWeight:\"bold\",gutterBottom:true,children:\"What to do next?\"}),/*#__PURE__*/_jsxs(Box,{sx:{textAlign:\"left\",mx:3,my:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\uD83D\\uDCE7 Check your email for the latest update form link\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\u23F3 Wait for the next reminder email (sent automatically)\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"\\u2709\\uFE0F Contact support if you believe this is an error\"})]}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",sx:{mt:2,display:\"block\"},children:\"You can close this window now.\"})]})});if(status===\"expired\")return/*#__PURE__*/_jsx(Box,{sx:{minHeight:\"100vh\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",bgcolor:\"#f8f9fa\",p:2},children:/*#__PURE__*/_jsxs(Paper,{sx:{width:\"100%\",maxWidth:480,p:4,borderRadius:3,boxShadow:4,textAlign:\"center\"},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",color:\"warning.main\",fontWeight:\"bold\",gutterBottom:true,children:\"\\u23F0 Form Expired\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{mb:2},children:\"Your 10-minute session has expired.\"}),/*#__PURE__*/_jsx(Divider,{sx:{my:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",fontWeight:\"bold\",gutterBottom:true,children:\"What happens next?\"}),/*#__PURE__*/_jsxs(Box,{sx:{textAlign:\"left\",mx:3,my:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\u2709\\uFE0F You will receive a new reminder email within 24 hours\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\uD83D\\uDD17 Use the new link to complete your form\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\uD83D\\uDCBE Your progress has been saved automatically\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"\\u23F1\\uFE0F You'll have another 10 minutes when you return\"})]}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",sx:{mt:2,display:\"block\"},children:\"You can close this window now.\"})]})});if(status===\"submitted\")return/*#__PURE__*/_jsx(Box,{sx:{minHeight:\"100vh\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",bgcolor:\"#f8f9fa\",p:2},children:/*#__PURE__*/_jsxs(Paper,{sx:{width:\"100%\",maxWidth:480,p:4,borderRadius:3,boxShadow:4,textAlign:\"center\"},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",color:\"success.main\",fontWeight:\"bold\",gutterBottom:true,children:\"\\u2705 Form Already Submitted\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{mb:2},children:\"You have already submitted this form successfully.\"}),/*#__PURE__*/_jsx(Divider,{sx:{my:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",fontWeight:\"bold\",gutterBottom:true,children:\"What happened?\"}),/*#__PURE__*/_jsxs(Box,{sx:{textAlign:\"left\",mx:3,my:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\u2705 Your form submission was completed successfully\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\uD83D\\uDCBE Your information has been saved in our system\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"\\uD83D\\uDD12 This link can no longer be used to prevent duplicate submissions\"})]}),/*#__PURE__*/_jsx(Divider,{sx:{my:2}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",fontWeight:\"bold\",gutterBottom:true,children:\"What to do next?\"}),/*#__PURE__*/_jsxs(Box,{sx:{textAlign:\"left\",mx:3,my:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\uD83D\\uDCE7 Check your email for confirmation\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mb:1},children:\"\\u2139\\uFE0F No further action is needed\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"\\u2709\\uFE0F Contact support if you need to update your information\"})]}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",sx:{mt:2,display:\"block\"},children:\"You can close this window now.\"})]})});// âœ… Deferred screen (auto-close + message)\nif(status===\"deferred\")return/*#__PURE__*/_jsx(Box,{sx:{minHeight:\"100vh\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",bgcolor:\"#f8f9fa\",textAlign:\"center\",p:3},children:/*#__PURE__*/_jsxs(Paper,{sx:{p:4,borderRadius:3,border:\"1px solid #ddd\",boxShadow:3,maxWidth:480},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",color:\"warning.main\",gutterBottom:true,children:\"\\u26A0\\uFE0F Form Deferred\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{mb:1},children:\"You\\u2019ve chosen to defer filling this form.\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mb:2},children:\"You can complete it later using the reminder email link we\\u2019ll send soon.\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"This window will close automatically in \",/*#__PURE__*/_jsx(\"b\",{children:countdown}),\" seconds.\"]})]})});// âœ… Main Form UI\nreturn/*#__PURE__*/_jsx(Box,{sx:{minHeight:\"100vh\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",bgcolor:\"#f8f9fa\",p:2,flex:1,width:\"100%\"},children:/*#__PURE__*/_jsxs(Paper,{sx:{width:\"100%\",maxWidth:480,p:4,borderRadius:3,boxShadow:4,border:\"1px solid #ddd\",opacity:fadeOut?0:1,transition:\"opacity 0.6s ease-in-out\"},children:[/*#__PURE__*/_jsxs(Stack,{alignItems:\"center\",spacing:1,children:[/*#__PURE__*/_jsxs(Stack,{direction:\"row\",spacing:1,alignItems:\"center\",children:[/*#__PURE__*/_jsx(\"img\",{src:logo1,alt:\"Logo1\",style:{width:45,height:45}}),/*#__PURE__*/_jsx(\"img\",{src:logo2,alt:\"Logo2\",style:{width:45,height:45}})]}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",fontWeight:\"bold\",children:\"Update Your Information\"}),/*#__PURE__*/_jsx(Box,{sx:{width:\"100%\",mt:1,p:1.5,borderRadius:2,backgroundColor:timeRemaining<=120?\"#ffebee\":timeRemaining<=300?\"#fff3e0\":\"#e3f2fd\",border:\"2px solid \".concat(timeRemaining<=120?\"#d32f2f\":timeRemaining<=300?\"#f57c00\":\"#1976d2\"),display:\"flex\",alignItems:\"center\",justifyContent:\"center\",gap:1},children:/*#__PURE__*/_jsxs(Typography,{sx:{fontSize:\"1.1rem\",fontWeight:\"bold\",color:timeRemaining<=120?\"#d32f2f\":timeRemaining<=300?\"#f57c00\":\"#1976d2\"},children:[\"\\u23F1\\uFE0F Time Remaining: \",Math.floor(timeRemaining/60),\":\",String(timeRemaining%60).padStart(2,\"0\")]})}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{color:timeRemaining<=120?\"#d32f2f\":\"text.secondary\",fontWeight:timeRemaining<=120?\"bold\":\"normal\"},children:timeRemaining<=120?\"âš ï¸ Hurry! Your session will expire soon!\":\"Complete the form within 10 minutes or it will expire\"}),/*#__PURE__*/_jsx(Divider,{sx:{width:\"100%\",my:1}})]}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,size:\"small\",sx:{mt:2},children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Continue as part of our organization?\"}),/*#__PURE__*/_jsxs(Select,{value:interested!==null&&interested!==void 0?interested:\"\",label:\"Continue?\",onChange:e=>setInterested(e.target.value),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"yes\",children:\"Yes, I want to continue\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"no\",children:\"No, I want to opt out\"})]})]}),interested===\"no\"?/*#__PURE__*/_jsxs(Box,{mt:3,children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"We're sorry to see you go. You may share feedback (optional):\"}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,multiline:true,rows:3,placeholder:\"Your reason...\",value:optoutReason,onChange:e=>setOptoutReason(e.target.value),sx:{mt:1}}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",color:\"error\",sx:{mt:2,borderRadius:\"20px\"},onClick:handleOptOut,disabled:optoutProcessing,children:optoutProcessing?\"Processing...\":\"Confirm Opt-Out\"})]}):/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:handleSubmit,mt:2,children:[/*#__PURE__*/_jsx(TextField,{label:\"Full Name *\",fullWidth:true,size:\"small\",margin:\"dense\",name:\"fullName\",value:formData.fullName,onChange:handleChange,required:true}),/*#__PURE__*/_jsx(TextField,{label:\"Phone *\",fullWidth:true,size:\"small\",margin:\"dense\",name:\"phone\",value:formData.phone,onChange:handleChange,disabled:phoneVerification.isVerified,required:true}),/*#__PURE__*/_jsx(TextField,{label:\"Email *\",fullWidth:true,size:\"small\",margin:\"dense\",name:\"email\",value:formData.email,onChange:handleChange,required:true}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,size:\"small\",margin:\"dense\",required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Gender *\"}),/*#__PURE__*/_jsx(Select,{value:formData.gender,label:\"Gender *\",onChange:handleChange,name:\"gender\",children:GENDERS.map(g=>/*#__PURE__*/_jsx(MenuItem,{value:g,children:g},g))})]}),/*#__PURE__*/_jsx(Autocomplete,{disablePortal:true,options:ORGANIZATIONS,value:formData.organisation||(showCustomOrg?\"Other\":\"\"),onChange:(e,newValue)=>handleOrgChange(e,newValue),renderInput:params=>/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{label:\"Organisation *\",size:\"small\",margin:\"dense\",required:true})),sx:{width:\"100%\"}}),showCustomOrg&&/*#__PURE__*/_jsx(TextField,{label:\"Enter Custom Organisation *\",fullWidth:true,size:\"small\",margin:\"dense\",required:true,value:formData.organisation===\"Other\"?\"\":formData.organisation,onChange:e=>{isDirtyRef.current=true;setFormData(_objectSpread(_objectSpread({},formData),{},{organisation:e.target.value,orgType:\"\"}));}}),showCustomOrg?/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,size:\"small\",margin:\"dense\",required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Organisation Type\"}),/*#__PURE__*/_jsxs(Select,{label:\"Organisation Type\",value:formData.orgType,onChange:e=>{isDirtyRef.current=true;setFormData(_objectSpread(_objectSpread({},formData),{},{orgType:e.target.value}));},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"Government\",children:\"Government\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Corporate\",children:\"Corporate\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Academic\",children:\"Academic\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"NGO\",children:\"NGO\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"Self\",children:\"Self\"})]})]}):/*#__PURE__*/_jsx(TextField,{label:\"Organisation Type\",fullWidth:true,size:\"small\",margin:\"dense\",value:formData.orgType,InputProps:{readOnly:true}}),/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,size:\"small\",margin:\"dense\",required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Role *\"}),/*#__PURE__*/_jsx(Select,{value:formData.role,label:\"Role *\",name:\"role\",onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{role:e.target.value})),children:ROLES.map(r=>/*#__PURE__*/_jsx(MenuItem,{value:r.value,children:r.label},r.value))})]}),/*#__PURE__*/_jsx(Typography,{fontWeight:\"bold\",fontSize:14,mt:2,mb:1,children:\"Social:\"}),/*#__PURE__*/_jsx(Typography,{fontWeight:\"bold\",fontSize:14,mt:1,mb:1,children:\"GitHub:\"}),/*#__PURE__*/_jsxs(Box,{sx:{display:\"flex\",flexDirection:\"column\",gap:1,width:\"100%\",mt:1},children:[/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",onClick:handleVerifyGithub,disabled:githubStatus.verified||githubStatus.verifying,sx:{borderRadius:\"10px\",fontWeight:\"bold\",backgroundColor:githubStatus.verified?\"#4CAF50\":\"#000\",color:\"white\",\"&:disabled\":{backgroundColor:githubStatus.verified?\"#4CAF50\":\"#9e9e9e\",color:\"white\"}},children:githubStatus.verified?\"GitHub Verified âœ“\":\"Verify GitHub\"}),githubStatus.verified&&/*#__PURE__*/_jsxs(Typography,{fontSize:13,color:\"#2e7d32\",children:[\"\\u2713 Verified as: \",githubStatus.username]}),!githubStatus.verified&&githubStatus.error&&/*#__PURE__*/_jsxs(Typography,{fontSize:13,color:\"#d32f2f\",children:[\"\\u274C \",githubStatus.error]})]}),/*#__PURE__*/_jsx(Typography,{fontWeight:\"bold\",fontSize:14,mt:2,mb:1,children:\"Discord:\"}),/*#__PURE__*/_jsx(Box,{sx:{display:\"flex\",flexDirection:\"column\",gap:1,width:\"100%\",mt:1},children:discordVerified?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",disabled:true,sx:{borderRadius:\"10px\",fontWeight:\"bold\",backgroundColor:\"#4CAF50\",color:\"white\",\"&.Mui-disabled\":{backgroundColor:\"#4CAF50\",color:\"white\"}},children:\"DISCORD VERIFIED \\u2713\"}),/*#__PURE__*/_jsxs(Typography,{fontSize:13,color:\"#2e7d32\",children:[\"\\u2713 Verified as: \",sessionStorage.getItem(\"discordUsername\")]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",sx:{borderRadius:\"10px\",fontWeight:\"bold\",backgroundColor:\"#1E4DD8\",\"&:hover\":{backgroundColor:\"#1536A1\"}},onClick:handleVerifyDiscord,disabled:discordStatus.verifying,startIcon:discordStatus.verifying?/*#__PURE__*/_jsx(CircularProgress,{size:20,color:\"inherit\"}):null,children:discordStatus.verifying?\"REDIRECTING...\":\"VERIFY DISCORD\"}),discordNotMember&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"outlined\",sx:{borderRadius:\"10px\",fontWeight:\"bold\"},onClick:()=>window.open(DISCORD_INVITE,\"_blank\"),children:\"JOIN DISCORD SERVER\"}),/*#__PURE__*/_jsx(Typography,{fontSize:13,color:\"#d32f2f\",children:\"\\u274C You must join our Discord server before verification.\"})]})]})}),/*#__PURE__*/_jsx(Typography,{fontWeight:\"bold\",fontSize:14,mt:2,mb:1,children:\"LinkedIn URL (Optional):\"}),/*#__PURE__*/_jsx(Box,{sx:{display:\"flex\",flexDirection:\"column\",gap:1,width:\"100%\",mt:1},children:/*#__PURE__*/_jsx(TextField,{label:\"Enter LinkedIn profile URL\",placeholder:\"https://www.linkedin.com/in/username\",value:formData.linkedinId,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{linkedinId:e.target.value})),size:\"small\",fullWidth:true})}),/*#__PURE__*/_jsxs(Box,{mt:2,children:[/*#__PURE__*/_jsx(\"div\",{id:\"recaptcha-container-update\"}),!phoneVerification.isVerified&&/*#__PURE__*/_jsxs(Stack,{direction:\"row\",spacing:2,mt:1,children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",fullWidth:true,onClick:handleRequestOtp,disabled:phoneVerification.isProcessing||timer>0,children:timer>0?\"Resend in \".concat(timer,\"s\"):phoneVerification.isProcessing?\"Sending...\":phoneVerification.showOtpInput?\"Resend OTP\":\"Send OTP\"}),phoneVerification.showOtpInput&&/*#__PURE__*/_jsx(TextField,{label:\"Enter 6-digit OTP\",size:\"small\",value:phoneVerification.otp,onChange:e=>{const onlyNums=e.target.value.replace(/\\D/g,\"\");if(onlyNums.length<=6)setPhoneVerification(_objectSpread(_objectSpread({},phoneVerification),{},{otp:onlyNums}));},inputProps:{inputMode:\"numeric\",pattern:\"[0-9]*\",maxLength:6,onKeyPress:e=>{if(!/[0-9]/.test(e.key))e.preventDefault();}}}),phoneVerification.showOtpInput&&/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:handleVerifyOtp,disabled:phoneVerification.isProcessing,children:phoneVerification.isProcessing?/*#__PURE__*/_jsx(CircularProgress,{size:18,color:\"inherit\"}):\"Verify\"})]}),phoneVerification.isVerified&&/*#__PURE__*/_jsx(Typography,{color:\"success.main\",mt:1,children:\"\\u2705 Phone verified successfully!\"})]}),/*#__PURE__*/_jsxs(Stack,{direction:\"row\",spacing:2,mt:3,children:[/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",fullWidth:true,disabled:!isFormComplete(),children:\"Submit\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",fullWidth:true,onClick:handleDefer,disabled:oauthInProgress,children:\"Defer\"})]})]})]})});};export default UpdateForm;","map":{"version":3,"names":["React","useEffect","useState","useRef","useSearchParams","API","validateToken","submitForm","deferForm","optOut","auth","signInWithPhoneNumber","RecaptchaVerifier","GithubAuthProvider","signInWithPopup","getAdditionalUserInfo","signOut","Swal","Box","Paper","Typography","TextField","Button","FormControl","InputLabel","Select","MenuItem","CircularProgress","Stack","Divider","Autocomplete","logo1","logo2","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ORGANIZATIONS","ORG_TYPE_MAPPINGS","TCS","Infosys","Wipro","Self","ROLES","value","label","ROLE_MAP","R004","R005","GENDERS","githubRegex","linkedinRegex","DISCORD_REDIRECT","DISCORD_INVITE","generateOAuthState","Math","random","toString","substring","Date","now","DISCORD_OAUTH","state","encodeURIComponent","UpdateForm","searchParams","token","get","formData","setFormData","fullName","email","phone","gender","organisation","orgType","role","githubId","githubUrl","discordId","linkedinId","phoneVerification","setPhoneVerification","isVerified","showOtpInput","otp","isProcessing","firebaseToken","status","setStatus","errorMessage","setErrorMessage","interested","setInterested","optoutReason","setOptoutReason","optoutProcessing","setOptoutProcessing","timer","setTimer","isDirtyRef","fadeOut","setFadeOut","countdown","setCountdown","timeRemaining","setTimeRemaining","showCustomOrg","setShowCustomOrg","isSubmitting","setIsSubmitting","recaptchaCleanedUp","recaptchaContainerIdRef","recaptchaWidgetIdRef","cleanupRecaptcha","aggressive","arguments","length","undefined","console","log","concat","window","recaptchaVerifier","clear","e","warn","grecaptcha","reset","current","container","document","getElementById","innerHTML","textContent","Array","from","attributes","forEach","attr","name","startsWith","removeAttribute","isFormComplete","_formData$fullName","_formData$email","_formData$phone","orgValue","trim","requiredFieldsFilled","socialVerified","githubStatus","verified","discordVerified","phoneVerified","setGithubStatus","verifying","username","avatar","error","setDiscordVerified","sessionStorage","getItem","discordNotMember","setDiscordNotMember","discordStatus","setDiscordStatus","oauthInProgress","setOauthInProgress","showAlert","text","icon","fire","confirmButtonColor","isReturningFromOAuth","savedFormData","savedToken","parsedData","JSON","parse","prev","_objectSpread","savedPhoneVerification","parsedPhoneData","post","inProgress","catch","err","removeItem","activateAndValidate","activateRes","res","data","valid","_partialRes$data","_activateRes$data","partialRes","activatedAt","activatedTime","getTime","elapsed","floor","remaining","max","setTimeout","alert","clearTimeout","message","_err$response","_err$response$data","errorMsg","response","setInterval","_unused","clearInterval","interval","t","url","notMember","discordUsername","close","verifiedAt","ageInMs","oneHourInMs","countdownInterval","title","html","confirmButtonText","handleVerifyGithub","_info$profile","provider","result","info","githubUsername","githubAvatar","profile","avatar_url","Error","verifiedUrl","setItem","_err$message","_err$message2","code","includes","handleVerifyDiscord","stringify","toISOString","location","href","handleOrgChange","event","handleChange","target","onlyNums","replace","handleRequestOtp","_formData$phone2","phoneNumber","p","uniqueContainerId","newDiv","createElement","id","className","appendChild","Promise","resolve","targetContainer","size","callback","expired-callback","widgetId","render","renderError","e164Phone","confirmationResult","_err$message3","handleVerifyOtp","confirm","user","getIdToken","verifiedState","handleSubmit","_formData$fullName2","_formData$email2","_formData$organisatio","preventDefault","showCancelButton","isConfirmed","_formData$fullName3","_formData$email3","_formData$organisatio2","_formData$githubUrl","_formData$githubId","_formData$discordId","_formData$linkedinId","_finalData$token","_finalData$firebaseTo","cleanedData","finalData","Object","keys","key","delete","_err$response2","_err$response3","_err$response4","_err$response4$data","_err$response5","_err$response6","_err$response6$data","userId","handleDefer","confirmDefer","_err$response7","_err$response7$data","handleOptOut","reason","_err$response8","_err$response8$data","align","children","sx","minHeight","display","justifyContent","alignItems","bgcolor","width","maxWidth","borderRadius","boxShadow","textAlign","variant","color","fontWeight","gutterBottom","mb","my","mx","mt","border","flex","opacity","transition","spacing","direction","src","alt","style","height","backgroundColor","gap","fontSize","String","padStart","fullWidth","onChange","multiline","rows","placeholder","onClick","disabled","component","onSubmit","margin","required","map","g","disablePortal","options","newValue","renderInput","params","InputProps","readOnly","r","flexDirection","startIcon","open","inputProps","inputMode","pattern","maxLength","onKeyPress","test","type"],"sources":["/home/rcts/Email-differ/Frontend/src/pages/Signin-otp/UpdateForm.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\nimport API, {\n  validateToken,\n  submitForm,\n  deferForm,\n  optOut,\n} from \"../../api/apiService\";\nimport { auth, signInWithPhoneNumber, RecaptchaVerifier } from \"../../firebase\";\nimport {\n  GithubAuthProvider,\n  signInWithPopup,\n  getAdditionalUserInfo,\n  signOut,\n} from \"firebase/auth\";\n\nimport Swal from \"sweetalert2\";\nimport {\n  Box,\n  Paper,\n  Typography,\n  TextField,\n  Button,\n  FormControl,\n  InputLabel,\n  Select,\n  MenuItem,\n  CircularProgress,\n  Stack,\n  Divider,\n  Autocomplete,\n} from \"@mui/material\";\nimport logo1 from \"../../assets/badal_logo.png\";\nimport logo2 from \"../../assets/c4gt_logo.png\";\n\nconst ORGANIZATIONS = [\n  \"Self\",\n  \"Government of India\",\n  \"NITI Aayog\",\n  \"Indian Institute of Technology\",\n  \"Indian Institute of Science\",\n  \"Microsoft India\",\n  \"Google India\",\n  \"TCS\",\n  \"Infosys\",\n  \"Wipro\",\n  \"Other\",\n];\n\nconst ORG_TYPE_MAPPINGS = {\n  \"Government of India\": \"Government\",\n  \"NITI Aayog\": \"Government\",\n  \"Indian Institute of Technology\": \"Academic\",\n  \"Indian Institute of Science\": \"Academic\",\n  \"Microsoft India\": \"Corporate\",\n  \"Google India\": \"Corporate\",\n  TCS: \"Corporate\",\n  Infosys: \"Corporate\",\n  Wipro: \"Corporate\",\n  Self: \"Self\",\n};\n\n// âœ… Role List (matching SignUpPage)\nconst ROLES = [\n  { value: \"R005\", label: \"Mentor\" },\n  { value: \"R004\", label: \"Developer\" },\n];\n\n// âœ… Role codes to backend strings (consistent with SignUpPage)\n// eslint-disable-next-line no-unused-vars\nconst ROLE_MAP = {\n  R004: \"Student\",\n  R005: \"Mentor\",\n};\n\nconst GENDERS = [\"Male\", \"Female\", \"Other\", \"Prefer not to say\"];\n\n// âœ… Validation regex (available for future use)\n// eslint-disable-next-line no-unused-vars\nconst githubRegex = /^https:\\/\\/(www\\.)?github\\.com\\/[A-Za-z0-9_-]+\\/?$/;\n// eslint-disable-next-line no-unused-vars\nconst linkedinRegex = /^https:\\/\\/(www\\.)?linkedin\\.com\\/in\\/[A-Za-z0-9_-]+\\/?$/;\n\nconst DISCORD_REDIRECT = \"https://pl-app.iiit.ac.in/rcts/account-setup/discord-callback\";\nconst DISCORD_INVITE = \"https://discord.com/invite/rQEcfQfXgu\";\n\n// âœ… Generate OAuth state for CSRF protection\nconst generateOAuthState = () => {\n  return Math.random().toString(36).substring(2) + Date.now().toString(36);\n};\n\nconst DISCORD_OAUTH = (state) =>\n  \"https://discord.com/oauth2/authorize\" +\n  \"?client_id=1450787791834447874\" +\n  \"&redirect_uri=\" +\n  encodeURIComponent(DISCORD_REDIRECT) +\n  \"&response_type=code\" +\n  \"&scope=identify%20guilds\" +\n  \"&state=\" + encodeURIComponent(state);\n\n// LinkedIn OAuth removed: collecting URL via input field instead\n\nconst UpdateForm = () => {\n  const [searchParams] = useSearchParams();\n  const token = searchParams.get(\"token\");\n\n  const [formData, setFormData] = useState({\n    fullName: \"\",\n    email: \"\",\n    phone: \"\",\n    gender: \"\",\n    organisation: \"\",\n    orgType: \"\",\n    role: \"\",\n    githubId: \"\",\n    githubUrl: \"\",\n    discordId: \"\",\n    linkedinId: \"\",\n  });\n\n  const [phoneVerification, setPhoneVerification] = useState({\n    isVerified: false,\n    showOtpInput: false,\n    otp: \"\",\n    isProcessing: false,\n    firebaseToken: null, // âœ… Store Firebase token for form submission\n  });\n\n  const [status, setStatus] = useState(\"loading\");\n  const [errorMessage, setErrorMessage] = useState(\"\");\n  const [interested, setInterested] = useState(null);\n  const [optoutReason, setOptoutReason] = useState(\"\");\n  const [optoutProcessing, setOptoutProcessing] = useState(false);\n  const [timer, setTimer] = useState(0);\n  const isDirtyRef = useRef(false);\n  const [fadeOut, setFadeOut] = useState(false);\n  const [countdown, setCountdown] = useState(5);\n  const [timeRemaining, setTimeRemaining] = useState(600); // 10 minutes in seconds\n  const [showCustomOrg, setShowCustomOrg] = useState(false); // âœ… Add for custom org handling\n  const [isSubmitting, setIsSubmitting] = useState(false); // âœ… Prevent double submit\n  const recaptchaCleanedUp = useRef(false); // âœ… Track recaptcha cleanup\n  const recaptchaContainerIdRef = useRef(0); // âœ… Track unique container IDs\n  const recaptchaWidgetIdRef = useRef(null); // âœ… Track widget ID for proper cleanup\n\n  // âœ… Reusable reCAPTCHA cleanup function\n  const cleanupRecaptcha = async (aggressive = false) => {\n    console.log(`ðŸ§¹ Cleaning up reCAPTCHA (aggressive: ${aggressive})...`);\n    \n    // Step 1: Clear Firebase RecaptchaVerifier\n    if (window.recaptchaVerifier) {\n      try {\n        await window.recaptchaVerifier.clear();\n        console.log('âœ“ Cleared recaptchaVerifier');\n      } catch (e) {\n        console.warn('Failed to clear recaptchaVerifier:', e);\n      }\n      delete window.recaptchaVerifier;\n      window.recaptchaVerifier = null;\n    }\n    \n    // Step 2: Reset ALL grecaptcha widgets aggressively\n    if (window.grecaptcha && window.grecaptcha.reset) {\n      try {\n        // Try to reset by widget ID first\n        if (recaptchaWidgetIdRef.current !== null) {\n          try {\n            window.grecaptcha.reset(recaptchaWidgetIdRef.current);\n            console.log(`âœ“ Reset grecaptcha widget ${recaptchaWidgetIdRef.current}`);\n          } catch (e) {\n            console.warn('Failed to reset specific widget:', e);\n          }\n        }\n        // Always try to reset without ID (resets all widgets)\n        try {\n          window.grecaptcha.reset();\n          console.log('âœ“ Reset all grecaptcha widgets');\n        } catch (e) {\n          console.warn('Failed to reset all widgets:', e);\n        }\n      } catch (e) {\n        console.warn('Failed to reset grecaptcha:', e);\n      }\n    }\n    recaptchaWidgetIdRef.current = null;\n    \n    // Step 3: Completely remove and recreate DOM container\n    const container = document.getElementById(\"recaptcha-container-update\");\n    if (container) {\n      // Remove ALL content and event listeners\n      container.innerHTML = \"\";\n      container.textContent = \"\";\n      \n      // Remove all data attributes that grecaptcha might have added\n      Array.from(container.attributes).forEach(attr => {\n        if (attr.name.startsWith('data-')) {\n          container.removeAttribute(attr.name);\n        }\n      });\n      \n      console.log('âœ“ Cleared DOM container completely');\n    }\n    \n    recaptchaCleanedUp.current = true;\n  };\n\n  // Form validation - check if all required fields are filled\n  const isFormComplete = () => {\n    // âœ… Check if submission is in progress\n    if (isSubmitting) return false;\n    \n    // âœ… Handle organisation as string or ensure it exists\n    const orgValue = typeof formData.organisation === 'string' \n      ? formData.organisation.trim() \n      : formData.organisation || \"\";\n    \n    const requiredFieldsFilled = \n      formData.fullName?.trim() !== \"\" &&\n      formData.email?.trim() !== \"\" &&\n      formData.phone?.trim() !== \"\" &&\n      formData.gender !== \"\" &&\n      orgValue !== \"\" &&\n      formData.orgType !== \"\" &&\n      formData.role !== \"\";\n    \n    const socialVerified = githubStatus.verified && discordVerified;\n    const phoneVerified = phoneVerification.isVerified;\n    \n    return requiredFieldsFilled && socialVerified && phoneVerified;\n  };\n\n  // OAuth verification states\n  const [githubStatus, setGithubStatus] = useState({\n    verifying: false,\n    verified: false,\n    username: \"\",\n    avatar: \"\", // âœ… Store avatar URL\n    error: \"\",\n  });\n  const [discordVerified, setDiscordVerified] = useState(\n    sessionStorage.getItem(\"discordVerified\") === \"true\"\n  );\n  const [discordNotMember, setDiscordNotMember] = useState(\n    sessionStorage.getItem(\"discordNotMember\") === \"true\"\n  );\n  const [discordStatus, setDiscordStatus] = useState({\n    verifying: false,\n  });\n  const [oauthInProgress, setOauthInProgress] = useState(false);\n\n  // ðŸ”” SweetAlert helper\n  const showAlert = (text, icon = \"info\") =>\n    Swal.fire({\n      text,\n      icon,\n      confirmButtonColor: \"#1E4DD8\",\n    });\n\n  // âœ… Restore UpdateForm context when returning from OAuth\n  useEffect(() => {\n    const isReturningFromOAuth = sessionStorage.getItem(\"isNavigating\");\n    if (isReturningFromOAuth) {\n      const savedFormData = sessionStorage.getItem(\"updateFormData\");\n      const savedToken = sessionStorage.getItem(\"updateFormToken\");\n      \n      if (savedFormData) {\n        try {\n          const parsedData = JSON.parse(savedFormData);\n          setFormData(prev => ({ ...prev, ...parsedData }));\n        } catch (e) {\n          console.error(\"Failed to restore form data:\", e);\n        }\n      }\n      \n      // âœ… Restore phone verification state\n      const savedPhoneVerification = sessionStorage.getItem(\"phoneVerificationState\");\n      if (savedPhoneVerification) {\n        try {\n          const parsedPhoneData = JSON.parse(savedPhoneVerification);\n          setPhoneVerification(prev => ({\n            ...prev,\n            isVerified: parsedPhoneData.isVerified,\n            firebaseToken: parsedPhoneData.firebaseToken,\n            showOtpInput: false, // Hide OTP input since already verified\n          }));\n          console.log(\"âœ… Restored phone verification state from sessionStorage\");\n        } catch (e) {\n          console.error(\"Failed to restore phone verification:\", e);\n        }\n      }\n      \n      // Clear OAuth in progress flag on backend\n      if (savedToken) {\n        API.post('/form/oauth-status', { token: savedToken, inProgress: false })\n          .catch(err => console.error(\"Failed to clear OAuth flag:\", err));\n      }\n      \n      sessionStorage.removeItem(\"isNavigating\");\n      sessionStorage.removeItem(\"updateFormData\");\n      sessionStorage.removeItem(\"updateFormToken\");\n      setOauthInProgress(false);\n    }\n  }, []);\n\n  // âœ… Token validation\n  useEffect(() => {\n    const activateAndValidate = async () => {\n      if (!token) {\n        setStatus(\"invalid\");\n        setErrorMessage(\"No token provided\");\n        return;\n      }\n\n      try {\n        // âœ… Activate token and get activatedAt timestamp\n        const activateRes = await API.post(\"/form/activate\", { token });\n        const res = await validateToken(token);\n\n        if (res.data.valid) {\n          setStatus(\"valid\");\n\n          const partialRes = await API.get(`/form/partial/${token}`);\n          if (partialRes.data?.data) {\n            setFormData((prev) => ({ ...prev, ...partialRes.data.data }));\n          }\n\n          // âœ… Calculate time remaining from backend activatedAt timestamp\n          if (activateRes.data?.activatedAt) {\n            const activatedTime = new Date(activateRes.data.activatedAt).getTime();\n            const now = Date.now();\n            const elapsed = Math.floor((now - activatedTime) / 1000); // seconds elapsed\n            const remaining = Math.max(0, 600 - elapsed); // 10 minutes = 600 seconds\n            setTimeRemaining(remaining);\n          }\n\n          // â° Token expires after 7 days (matches backend expiry window)\n          const timer = setTimeout(() => {\n            setStatus(\"expired\");\n            alert(\n              \"This link has expired. Please check your email for a new update link.\"\n            );\n          }, 7 * 24 * 60 * 60 * 1000); // 7 days\n\n          return () => clearTimeout(timer);\n        } else {\n          setStatus(\"invalid\");\n          setErrorMessage(res.data.message || \"Invalid token\");\n        }\n      } catch (err) {\n        const errorMsg = err.response?.data?.message || \"Failed to load form\";\n        \n        // âœ… Check if form was already submitted\n        if (errorMsg === \"Form already submitted\") {\n          setStatus(\"submitted\");\n        } else {\n          setStatus(\"invalid\");\n          setErrorMessage(errorMsg);\n        }\n      }\n    };\n    activateAndValidate();\n  }, [token]);\n\n  // âœ… Clean up reCAPTCHA on component unmount\n  useEffect(() => {\n    return () => {\n      cleanupRecaptcha(true); // Aggressive cleanup on unmount\n    };\n  }, []);\n\n  // âœ… Auto-save every 5 seconds (only if form data changed)\n  useEffect(() => {\n    if (status !== \"valid\") return;\n    const timer = setInterval(async () => {\n      // âœ… Only save if form data has changed\n      if (!isDirtyRef.current) return;\n      \n      try {\n        await API.post(`/form/save-partial`, { token, data: formData });\n        isDirtyRef.current = false; // âœ… Reset dirty flag after successful save\n      } catch {}\n    }, 5000);\n    return () => clearInterval(timer);\n  }, [formData, status, token]);\n\n  // â± Resend timer\n  useEffect(() => {\n    if (timer > 0) {\n      const interval = setInterval(() => setTimer((t) => t - 1), 1000);\n      return () => clearInterval(interval);\n    }\n  }, [timer]);\n  \n  // Restore GitHub verification from sessionStorage\n  useEffect(() => {\n    const verified = sessionStorage.getItem(\"githubVerified\") === \"true\";\n    const username = sessionStorage.getItem(\"githubUsername\");\n    const url = sessionStorage.getItem(\"githubUrl\");\n\n    if (verified && username && url) {\n      setGithubStatus({\n        verifying: false,\n        verified: true,\n        username,\n        error: \"\",\n      });\n      setFormData(prev => ({ ...prev, githubUrl: url }));\n    }\n  }, []);\n  \n  // Restore Discord verification from sessionStorage\n  useEffect(() => {\n    const verified = sessionStorage.getItem(\"discordVerified\") === \"true\";\n    const notMember = sessionStorage.getItem(\"discordNotMember\") === \"true\";\n\n    setDiscordVerified(verified);\n    setDiscordNotMember(notMember);\n\n    if (verified) {\n      const discordUsername = sessionStorage.getItem(\"discordUsername\");\n      if (discordUsername) {\n        // Use username (display name like \"user#1234\"), not numeric ID\n        setFormData((prev) => ({ ...prev, discordId: discordUsername }));\n      }\n    }\n  }, []);\n  // âœ… Auto-close tab + countdown when deferred\n  useEffect(() => {\n    if (status === \"deferred\") {\n      const interval = setInterval(() => {\n        setCountdown((prev) => {\n          if (prev <= 1) {\n            window.close(); // auto-close after countdown\n            clearInterval(interval);\n            return 0;\n          }\n          return prev - 1;\n        });\n      }, 1000);\n      return () => clearInterval(interval);\n    }\n  }, [status]);\n\n  // Restore GitHub verification from sessionStorage\n  useEffect(() => {\n    const verified = sessionStorage.getItem(\"githubVerified\") === \"true\";\n    const username = sessionStorage.getItem(\"githubUsername\");\n    const url = sessionStorage.getItem(\"githubUrl\");\n\n    if (verified && username && url) {\n      setGithubStatus({\n        verifying: false,\n        verified: true,\n        username,\n        error: \"\",\n      });\n      setFormData(prev => ({ ...prev, githubUrl: url }));\n    }\n  }, []);\n\n  // âœ… Restore phone verification from sessionStorage on mount\n  useEffect(() => {\n    const savedPhoneVerification = sessionStorage.getItem(\"phoneVerificationState\");\n    if (savedPhoneVerification) {\n      try {\n        const parsedPhoneData = JSON.parse(savedPhoneVerification);\n        // Check if verification is still recent (within 1 hour)\n        const verifiedAt = new Date(parsedPhoneData.verifiedAt);\n        const now = new Date();\n        const ageInMs = now - verifiedAt;\n        const oneHourInMs = 60 * 60 * 1000;\n        \n        if (ageInMs < oneHourInMs) {\n          setPhoneVerification(prev => ({\n            ...prev,\n            isVerified: parsedPhoneData.isVerified,\n            firebaseToken: parsedPhoneData.firebaseToken,\n            showOtpInput: false,\n          }));\n          console.log(\"âœ… Restored phone verification from sessionStorage on mount\");\n        } else {\n          // Expired - clear it\n          sessionStorage.removeItem(\"phoneVerificationState\");\n          console.log(\"âš ï¸ Phone verification expired, cleared from sessionStorage\");\n        }\n      } catch (e) {\n        console.error(\"Failed to restore phone verification on mount:\", e);\n      }\n    }\n  }, []);\n\n  // âœ… 10-minute countdown timer with auto-expiry\n  useEffect(() => {\n    if (status === \"valid\" && timeRemaining > 0) {\n      const countdownInterval = setInterval(() => {\n        setTimeRemaining((prev) => {\n          if (prev <= 1) {\n            clearInterval(countdownInterval);\n            setStatus(\"expired\");\n            Swal.fire({\n              icon: \"warning\",\n              title: \"Token Expired\",\n              html: `\n                <p>Your form session has expired after 10 minutes.</p>\n                <p><strong>What happens next?</strong></p>\n                <ul style=\"text-align: left; margin: 10px 20px;\">\n                  <li>This form will be automatically closed</li>\n                  <li>You will receive a new reminder email within 24 hours</li>\n                  <li>You can complete the form using the new link</li>\n                </ul>\n              `,\n              confirmButtonColor: \"#1E4DD8\",\n              confirmButtonText: \"OK\",\n            });\n            return 0;\n          }\n          return prev - 1;\n        });\n      }, 1000);\n\n      return () => clearInterval(countdownInterval);\n    }\n  }, [status, timeRemaining]);\n\n  // âœ… Verify GitHub\n  const handleVerifyGithub = async () => {\n    setGithubStatus({\n      verifying: true,\n      verified: false,\n      username: \"\",\n      avatar: \"\",\n      error: \"\",\n    });\n\n    try {\n      const provider = new GithubAuthProvider();\n      const result = await signInWithPopup(auth, provider);\n\n      const info = getAdditionalUserInfo(result);\n      const githubUsername = info?.username;\n      const githubAvatar = info?.profile?.avatar_url || \"\";\n\n      if (!githubUsername) throw new Error(\"Unable to retrieve GitHub username\");\n\n      const verifiedUrl = `https://github.com/${githubUsername}`;\n      \n      setFormData(prev => ({ ...prev, githubUrl: verifiedUrl }));\n\n      // âœ… Store in sessionStorage for persistence\n      sessionStorage.setItem(\"githubVerified\", \"true\");\n      sessionStorage.setItem(\"githubUsername\", githubUsername);\n      sessionStorage.setItem(\"githubUrl\", verifiedUrl);\n      sessionStorage.setItem(\"githubAvatar\", githubAvatar);\n\n      setGithubStatus({\n        verifying: false,\n        verified: true,\n        username: githubUsername,\n        avatar: githubAvatar,\n        error: \"\",\n      });\n\n      await signOut(auth);\n      showAlert(\"GitHub verified successfully!\", \"success\");\n    } catch (err) {\n      console.error(\"GitHub verify error:\", err);\n      \n      // âœ… Handle different error types\n      let errorMsg = \"GitHub verification failed. Please try again.\";\n      \n      if (err.code === \"auth/popup-closed-by-user\") {\n        errorMsg = \"Verification cancelled. Please try again.\";\n      } else if (err.code === \"auth/popup-blocked\") {\n        errorMsg = \"Popup was blocked by your browser. Please allow popups for this site and try again.\";\n      } else if (err.code === \"auth/cancelled-popup-request\") {\n        errorMsg = \"Verification cancelled. Please try again.\";\n      } else if (err.message?.includes(\"rate\") || err.message?.includes(\"limit\")) {\n        errorMsg = \"Too many verification attempts. Please wait a few minutes and try again.\";\n      }\n      \n      setGithubStatus({\n        verifying: false,\n        verified: false,\n        username: \"\",\n        avatar: \"\",\n        error: errorMsg,\n      });\n      \n      if (err.code !== \"auth/popup-closed-by-user\") {\n        showAlert(errorMsg, \"error\");\n      }\n    }\n  };\n\n  // âœ… Verify Discord (redirect-based)\n  const handleVerifyDiscord = async () => {\n    try {\n      // âœ… Set verifying state\n      setDiscordStatus({ verifying: true });\n      \n      // âœ… Generate OAuth state for CSRF protection\n      const state = generateOAuthState();\n      sessionStorage.setItem(\"discordOAuthState\", state);\n      \n      // âœ… Clear stale member flag before starting\n      sessionStorage.removeItem(\"discordNotMember\");\n      setDiscordNotMember(false);\n      \n      // Mark OAuth as in progress to extend token expiry\n      await API.post('/form/oauth-status', { token, inProgress: true });\n      \n      // Save form data and token before redirect\n      sessionStorage.setItem(\"updateFormData\", JSON.stringify(formData));\n      sessionStorage.setItem(\"updateFormToken\", token);\n      \n      // âœ… Save phone verification state if verified\n      if (phoneVerification.isVerified && phoneVerification.firebaseToken) {\n        sessionStorage.setItem(\"phoneVerificationState\", JSON.stringify({\n          isVerified: true,\n          firebaseToken: phoneVerification.firebaseToken,\n          verifiedAt: new Date().toISOString(),\n        }));\n      }\n      sessionStorage.setItem(\"oauthReturnPath\", `/update-form?token=${token}`);\n      \n      setOauthInProgress(true);\n      \n      // âœ… Show loading state briefly before redirect\n      showAlert(\"Redirecting to Discord...\", \"info\");\n      \n      // Redirect to Discord OAuth with state\n      setTimeout(() => {\n        window.location.href = DISCORD_OAUTH(state);\n      }, 500);\n    } catch (err) {\n      console.error(\"Failed to mark OAuth in progress:\", err);\n      setOauthInProgress(false); // âœ… Clear flag to allow retry\n      setDiscordStatus({ verifying: false }); // âœ… Reset verifying state\n      showAlert(\"Failed to start Discord verification. Please try again.\", \"error\");\n    }\n  };\n\n  // âœ… Handle organization change (like SignUpPage)\n  const handleOrgChange = (event, value) => {\n    isDirtyRef.current = true;\n    \n    if (!value) {\n      setShowCustomOrg(false);\n      setFormData({ ...formData, organisation: \"\", orgType: \"\" });\n      return;\n    }\n\n    if (value === \"Other\") {\n      setShowCustomOrg(true);\n      setFormData({ ...formData, organisation: \"\", orgType: \"\" });\n    } else {\n      setShowCustomOrg(false);\n      const orgType = ORG_TYPE_MAPPINGS[value] || \"\";\n      setFormData({ ...formData, organisation: value, orgType });\n    }\n  };\n\n  // âœ… Handle changes\n  const handleChange = (e) => {\n    isDirtyRef.current = true;\n    const { name, value } = e.target;\n\n    // âœ… Numeric-only phone input (10 digits)\n    if (name === \"phone\") {\n      const onlyNums = value.replace(/\\D/g, \"\");\n      if (onlyNums.length <= 10) {\n        setFormData({ ...formData, phone: onlyNums });\n        // Reset phone verification when phone changes\n        setPhoneVerification({\n          isVerified: false,\n          showOtpInput: false,\n          otp: \"\",\n          isProcessing: false,\n          firebaseToken: null,\n        });\n        \n        // âœ… Clear from sessionStorage when phone changes\n        sessionStorage.removeItem(\"phoneVerificationState\");\n        \n        // âœ… Clean up reCAPTCHA when phone changes\n        cleanupRecaptcha(false);\n      }\n      return;\n    }\n\n    setFormData({ ...formData, [name]: value });\n  };\n\n  // âœ… Request OTP\n  const handleRequestOtp = async () => {\n    const phoneNumber = formData.phone?.trim();\n    if (!phoneNumber || phoneNumber.length !== 10) {\n      return showAlert(\n        \"Please enter a valid 10-digit phone number.\",\n        \"warning\"\n      );\n    }\n\n    if (timer > 0)\n      return showAlert(`Please wait ${timer}s before resending OTP.`, \"info\");\n\n    // âœ… Prevent multiple rapid clicks\n    if (phoneVerification.isProcessing) {\n      console.log('âš ï¸ OTP request already in progress');\n      return;\n    }\n\n    setPhoneVerification((p) => ({ ...p, isProcessing: true }));\n\n    try {\n      // âœ… Use aggressive cleanup utility\n      await cleanupRecaptcha(true);\n      \n      // Generate unique container ID\n      recaptchaContainerIdRef.current += 1;\n      const uniqueContainerId = `recaptcha-container-update-${recaptchaContainerIdRef.current}`;\n      \n      // Recreate container\n      const container = document.getElementById(\"recaptcha-container-update\");\n      if (!container) {\n        console.error('âŒ recaptcha-container-update not found in DOM');\n        throw new Error('reCAPTCHA container not found');\n      }\n      \n      // Create fresh inner div\n      const newDiv = document.createElement('div');\n      newDiv.id = uniqueContainerId;\n      newDiv.className = 'recaptcha-inner';\n      container.appendChild(newDiv);\n\n      // Wait for DOM to be ready\n      await new Promise(resolve => setTimeout(resolve, 200));\n      \n      // Verify container exists\n      const targetContainer = document.getElementById(uniqueContainerId);\n      if (!targetContainer) {\n        throw new Error(`Container ${uniqueContainerId} not found after creation`);\n      }\n      \n      console.log(`âœ“ Created fresh container: ${uniqueContainerId}`);\n\n      // Step 6: Create new RecaptchaVerifier with unique container\n      console.log('ðŸ”§ Creating new RecaptchaVerifier...');\n      window.recaptchaVerifier = new RecaptchaVerifier(\n        auth,\n        uniqueContainerId,\n        {\n          size: \"invisible\",\n          callback: () => console.log(\"reCAPTCHA solved\"),\n          \"expired-callback\": () => console.warn(\"reCAPTCHA expired\"),\n        }\n      );\n\n      // Step 7: Render and store widget ID (with additional error handling)\n      let widgetId;\n      try {\n        widgetId = await window.recaptchaVerifier.render();\n        recaptchaWidgetIdRef.current = widgetId;\n        console.log(`âœ… reCAPTCHA rendered successfully in ${uniqueContainerId} (widget ID: ${widgetId})`);\n      } catch (renderError) {\n        // If render still fails, try one more time with complete reset\n        console.warn('âš ï¸ First render attempt failed, trying complete reset...', renderError);\n        \n        // Nuclear option: reload grecaptcha script\n        if (window.grecaptcha) {\n          delete window.grecaptcha;\n        }\n        \n        // Wait a bit longer\n        await new Promise(resolve => setTimeout(resolve, 500));\n        \n        // Try to render again\n        widgetId = await window.recaptchaVerifier.render();\n        recaptchaWidgetIdRef.current = widgetId;\n        console.log(`âœ… reCAPTCHA rendered successfully on retry (widget ID: ${widgetId})`);\n      }\n\n      const e164Phone = `+91${phoneNumber}`;\n      const confirmationResult = await signInWithPhoneNumber(\n        auth,\n        e164Phone,\n        window.recaptchaVerifier\n      );\n      window.confirmationResult = confirmationResult;\n\n      showAlert(\"OTP sent successfully to your phone!\", \"success\");\n      setPhoneVerification({\n        showOtpInput: true,\n        isVerified: false,\n        otp: \"\",\n        isProcessing: false,\n      });\n      setTimer(30); // cooldown\n      recaptchaCleanedUp.current = false;\n    } catch (err) {\n      console.error(\"OTP send error:\", err);\n      \n      // âœ… Provide user-friendly error messages\n      let errorMsg = \"Failed to send OTP. Please try again.\";\n      if (err.code === \"auth/too-many-requests\") {\n        errorMsg = \"Too many attempts. Please try again later.\";\n      } else if (err.code === \"auth/invalid-phone-number\") {\n        errorMsg = \"Invalid phone number format.\";\n      } else if (err.message?.includes(\"reCAPTCHA\")) {\n        errorMsg = err.message;\n      }\n      \n      showAlert(errorMsg, \"error\");\n      \n      // âœ… Clean up on error\n      await cleanupRecaptcha(true);\n      \n      setPhoneVerification((p) => ({ ...p, isProcessing: false }));\n    }\n  };\n\n  // âœ… Verify OTP\n  const handleVerifyOtp = async () => {\n    if (!phoneVerification.otp.trim() || phoneVerification.otp.length !== 6) {\n      return showAlert(\"Please enter a valid 6-digit OTP.\", \"warning\");\n    }\n\n    setPhoneVerification((p) => ({ ...p, isProcessing: true }));\n\n    try {\n      const result = await window.confirmationResult.confirm(\n        phoneVerification.otp\n      );\n      const user = result.user;\n      const firebaseToken = await user.getIdToken();\n\n      // âœ… Send phone with +91 prefix\n      await API.post(`/form/verify-phone`, {\n        token,\n        phone: formData.phone, // Backend will normalize\n        firebaseToken,\n      });\n\n      showAlert(\"Phone verified successfully!\", \"success\");\n\n      const verifiedState = {\n        ...phoneVerification,\n        isVerified: true,\n        isProcessing: false,\n        firebaseToken, // âœ… Store token for form submission\n      };\n      \n      setPhoneVerification(verifiedState);\n      \n      // âœ… Save to sessionStorage to persist across OAuth redirects\n      sessionStorage.setItem(\"phoneVerificationState\", JSON.stringify({\n        isVerified: true,\n        firebaseToken,\n        verifiedAt: new Date().toISOString(),\n      }));\n      \n      // âœ… Clean up recaptcha after successful verification\n      await cleanupRecaptcha(false);\n    } catch (err) {\n      console.error(\"OTP verification failed:\", err);\n      \n      // âœ… User-friendly error messages\n      let errorMsg = \"Invalid or expired OTP. Please try again.\";\n      if (err.code === \"auth/invalid-verification-code\") {\n        errorMsg = \"Invalid OTP code. Please check and try again.\";\n      } else if (err.code === \"auth/code-expired\") {\n        errorMsg = \"OTP has expired. Please request a new one.\";\n      }\n      \n      showAlert(errorMsg, \"error\");\n      \n      // âœ… Clear verifier to allow retry\n      await cleanupRecaptcha(false);\n      \n      setPhoneVerification((p) => ({ ...p, isProcessing: false }));\n    }\n  };\n\n  // âœ… Submit\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    // âœ… Prevent double submission\n    if (isSubmitting) {\n      return;\n    }\n\n    // âœ… Detailed validation\n    if (!formData.fullName?.trim()) {\n      return showAlert(\"Please enter your full name.\", \"warning\");\n    }\n    if (!formData.phone || formData.phone.length !== 10) {\n      return showAlert(\"Please enter a valid 10-digit phone number.\", \"warning\");\n    }\n    if (!formData.email?.trim() || !formData.email.includes(\"@\")) {\n      return showAlert(\"Please enter a valid email address.\", \"warning\");\n    }\n    if (!formData.gender) {\n      return showAlert(\"Please select your gender.\", \"warning\");\n    }\n    if (!formData.organisation?.trim()) {\n      return showAlert(\"Please select or enter your organisation.\", \"warning\");\n    }\n    if (!formData.role) {\n      return showAlert(\"Please select your role.\", \"warning\");\n    }\n    if (!githubStatus.verified) {\n      return showAlert(\"Please verify your GitHub account before submitting.\", \"warning\");\n    }\n    if (!discordVerified) {\n      return showAlert(\"Please verify your Discord account before submitting.\", \"warning\");\n    }\n    if (!phoneVerification.isVerified) {\n      return showAlert(\"Please verify your phone number before submitting.\", \"warning\");\n    }\n\n    const confirm = await Swal.fire({\n      title: \"Confirm Submission?\",\n      text: \"Please review your information before submitting.\",\n      icon: \"question\",\n      showCancelButton: true,\n      confirmButtonText: \"Submit\",\n      confirmButtonColor: \"#1E4DD8\",\n    });\n\n    if (!confirm.isConfirmed) return;\n\n    // âœ… Prevent multiple submissions\n    if (isSubmitting) {\n      console.log('âš ï¸ Submission already in progress');\n      return;\n    }\n\n    setIsSubmitting(true);\n\n    try {\n      isDirtyRef.current = false;\n      \n      // âœ… Get verified social media data from sessionStorage\n      const githubUsername = sessionStorage.getItem(\"githubUsername\") || \"\";\n      const githubUrl = sessionStorage.getItem(\"githubUrl\") || \"\";\n      const discordId = sessionStorage.getItem(\"discordId\") || \"\";\n      const discordUsername = sessionStorage.getItem(\"discordUsername\") || \"\";\n      \n      const cleanedData = {\n        fullName: formData.fullName?.trim(),\n        email: formData.email?.trim(),\n        phone: formData.phone,\n        gender: formData.gender,\n        organisation: formData.organisation?.trim(),\n        orgType: formData.orgType,\n        role: formData.role,\n        githubUrl: githubUrl || formData.githubUrl?.trim() || null,\n        githubId: githubUsername || formData.githubId?.trim() || null,\n        discordId: discordId || formData.discordId?.trim() || null,\n        linkedinId: formData.linkedinId?.trim() || null,\n        token,\n        firebaseToken: phoneVerification.firebaseToken, // âœ… Include Firebase token\n      };\n      \n      // âœ… Remove null/empty fields (but keep token and firebaseToken)\n      const finalData = {};\n      Object.keys(cleanedData).forEach(key => {\n        // Always include token and firebaseToken\n        if (key === 'token' || key === 'firebaseToken') {\n          finalData[key] = cleanedData[key];\n        } else if (cleanedData[key] !== null && cleanedData[key] !== \"\") {\n          finalData[key] = cleanedData[key];\n        }\n      });\n      \n      // âœ… Debug logging\n      console.log('ðŸ“¤ Submitting form with keys:', Object.keys(finalData));\n      console.log('ðŸ“¤ Token:', finalData.token?.substring(0, 10) + '...');\n      console.log('ðŸ“¤ Firebase token:', finalData.firebaseToken?.substring(0, 20) + '...');\n      \n      await submitForm(finalData);\n      await API.delete(`/form/partial/${token}`);\n      \n      sessionStorage.removeItem(\"updateFormData\");\n      sessionStorage.removeItem(\"updateFormToken\");\n      sessionStorage.removeItem(\"oauthReturnPath\");\n      sessionStorage.removeItem(\"phoneVerificationState\"); // âœ… Clear phone verification\n      sessionStorage.removeItem(\"githubVerified\");\n      sessionStorage.removeItem(\"githubUsername\");\n      sessionStorage.removeItem(\"githubUrl\");\n      sessionStorage.removeItem(\"githubAvatar\");\n      sessionStorage.removeItem(\"discordVerified\");\n      sessionStorage.removeItem(\"discordUsername\");\n      sessionStorage.removeItem(\"discordId\");\n      sessionStorage.removeItem(\"discordAvatarUrl\");\n      sessionStorage.removeItem(\"discordNotMember\");\n      sessionStorage.removeItem(\"discordOAuthState\");\n      \n      setStatus(\"submitted\");\n      showAlert(\"Form submitted successfully!\", \"success\");\n    } catch (err) {\n      console.error(\"Submission error:\", err);\n      console.error(\"Error response:\", err.response?.data);\n      console.error(\"Error status:\", err.response?.status);\n      \n      const errorMessage = err.response?.data?.message || \"Submission failed. Please try again.\";\n      \n      // âœ… Handle 409 Conflict (user already exists)\n      if (err.response?.status === 409) {\n        const userId = err.response?.data?.userId;\n        showAlert(\n          `This account already exists${userId ? ` (User ID: ${userId})` : ''}. ${errorMessage}`,\n          \"error\"\n        );\n        return;\n      }\n      \n      // âœ… If phone conflict error, reset phone verification so user can change number\n      if (errorMessage.includes(\"phone number\") || errorMessage.includes(\"already registered\")) {\n        setPhoneVerification({\n          isVerified: false,\n          showOtpInput: false,\n          otp: \"\",\n          isProcessing: false,\n          firebaseToken: null,\n        });\n        showAlert(\n          \"This phone number is already registered with a different account. Please use a different number or verify with the correct account.\",\n          \"error\"\n        );\n      } else {\n        showAlert(errorMessage, \"error\");\n      }\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  // âœ… Defer\n  // âœ… Defer (with confirmation + smooth exit)\n  const handleDefer = async () => {\n    const confirmDefer = window.confirm(\n      \"Are you sure you want to defer filling this form?\\nYouâ€™ll receive a reminder email later.\"\n    );\n    if (!confirmDefer) return; // user chose No â€” stay on form\n\n    try {\n      await deferForm({ token });\n      setFadeOut(true);\n      setTimeout(() => setStatus(\"deferred\"), 600); // fade-out animation time\n    } catch (err) {\n      showAlert(\n        err.response?.data?.message || \"Failed to defer form.\",\n        \"error\"\n      );\n    }\n  };\n\n  // âœ… Opt-out\n  const handleOptOut = async () => {\n    const confirm = await Swal.fire({\n      title: \"Confirm Opt-Out?\",\n      text: \"You wonâ€™t receive future communications.\",\n      icon: \"warning\",\n      showCancelButton: true,\n      confirmButtonText: \"Opt Out\",\n      confirmButtonColor: \"#d33\",\n    });\n\n    if (!confirm.isConfirmed) return;\n\n    setOptoutProcessing(true);\n    try {\n      await optOut({ token, reason: optoutReason });\n      setOptoutProcessing(false);\n      setInterested(\"no\");\n      setStatus(\"deferred\");\n      showAlert(\"You have been opted out successfully.\", \"success\");\n    } catch (err) {\n      setOptoutProcessing(false);\n      showAlert(err.response?.data?.message || \"Failed to opt out.\", \"error\");\n    }\n  };\n\n  // âœ… Conditional Views\n  if (status === \"loading\")\n    return <Typography align=\"center\">Loading form...</Typography>;\n  if (status === \"invalid\")\n    return (\n      <Box\n        sx={{\n          minHeight: \"100vh\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          bgcolor: \"#f8f9fa\",\n          p: 2,\n        }}\n      >\n        <Paper\n          sx={{\n            width: \"100%\",\n            maxWidth: 480,\n            p: 4,\n            borderRadius: 3,\n            boxShadow: 4,\n            textAlign: \"center\",\n          }}\n        >\n          <Typography variant=\"h5\" color=\"error\" fontWeight=\"bold\" gutterBottom>\n            âŒ Invalid or Expired Link\n          </Typography>\n          <Typography variant=\"body1\" sx={{ mb: 2 }}>\n            {errorMessage || \"This link is no longer valid.\"}\n          </Typography>\n          <Divider sx={{ my: 2 }} />\n          <Typography variant=\"h6\" fontWeight=\"bold\" gutterBottom>\n            What happened?\n          </Typography>\n          <Box sx={{ textAlign: \"left\", mx: 3, my: 2 }}>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              ðŸ”— The link may have already been used\n            </Typography>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              â° The link may have expired (7 days validity)\n            </Typography>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              âœ… You may have already submitted the form\n            </Typography>\n            <Typography variant=\"body2\">\n              ðŸš« You may have opted out or deferred\n            </Typography>\n          </Box>\n          <Divider sx={{ my: 2 }} />\n          <Typography variant=\"h6\" fontWeight=\"bold\" gutterBottom>\n            What to do next?\n          </Typography>\n          <Box sx={{ textAlign: \"left\", mx: 3, my: 2 }}>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              ðŸ“§ Check your email for the latest update form link\n            </Typography>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              â³ Wait for the next reminder email (sent automatically)\n            </Typography>\n            <Typography variant=\"body2\">\n              âœ‰ï¸ Contact support if you believe this is an error\n            </Typography>\n          </Box>\n          <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mt: 2, display: \"block\" }}>\n            You can close this window now.\n          </Typography>\n        </Paper>\n      </Box>\n    );\n  if (status === \"expired\")\n    return (\n      <Box\n        sx={{\n          minHeight: \"100vh\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          bgcolor: \"#f8f9fa\",\n          p: 2,\n        }}\n      >\n        <Paper\n          sx={{\n            width: \"100%\",\n            maxWidth: 480,\n            p: 4,\n            borderRadius: 3,\n            boxShadow: 4,\n            textAlign: \"center\",\n          }}\n        >\n          <Typography variant=\"h5\" color=\"warning.main\" fontWeight=\"bold\" gutterBottom>\n            â° Form Expired\n          </Typography>\n          <Typography variant=\"body1\" sx={{ mb: 2 }}>\n            Your 10-minute session has expired.\n          </Typography>\n          <Divider sx={{ my: 2 }} />\n          <Typography variant=\"h6\" fontWeight=\"bold\" gutterBottom>\n            What happens next?\n          </Typography>\n          <Box sx={{ textAlign: \"left\", mx: 3, my: 2 }}>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              âœ‰ï¸ You will receive a new reminder email within 24 hours\n            </Typography>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              ðŸ”— Use the new link to complete your form\n            </Typography>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              ðŸ’¾ Your progress has been saved automatically\n            </Typography>\n            <Typography variant=\"body2\">\n              â±ï¸ You'll have another 10 minutes when you return\n            </Typography>\n          </Box>\n          <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mt: 2, display: \"block\" }}>\n            You can close this window now.\n          </Typography>\n        </Paper>\n      </Box>\n    );\n  if (status === \"submitted\")\n    return (\n      <Box\n        sx={{\n          minHeight: \"100vh\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          bgcolor: \"#f8f9fa\",\n          p: 2,\n        }}\n      >\n        <Paper\n          sx={{\n            width: \"100%\",\n            maxWidth: 480,\n            p: 4,\n            borderRadius: 3,\n            boxShadow: 4,\n            textAlign: \"center\",\n          }}\n        >\n          <Typography variant=\"h5\" color=\"success.main\" fontWeight=\"bold\" gutterBottom>\n            âœ… Form Already Submitted\n          </Typography>\n          <Typography variant=\"body1\" sx={{ mb: 2 }}>\n            You have already submitted this form successfully.\n          </Typography>\n          <Divider sx={{ my: 2 }} />\n          <Typography variant=\"h6\" fontWeight=\"bold\" gutterBottom>\n            What happened?\n          </Typography>\n          <Box sx={{ textAlign: \"left\", mx: 3, my: 2 }}>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              âœ… Your form submission was completed successfully\n            </Typography>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              ðŸ’¾ Your information has been saved in our system\n            </Typography>\n            <Typography variant=\"body2\">\n              ðŸ”’ This link can no longer be used to prevent duplicate submissions\n            </Typography>\n          </Box>\n          <Divider sx={{ my: 2 }} />\n          <Typography variant=\"h6\" fontWeight=\"bold\" gutterBottom>\n            What to do next?\n          </Typography>\n          <Box sx={{ textAlign: \"left\", mx: 3, my: 2 }}>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              ðŸ“§ Check your email for confirmation\n            </Typography>\n            <Typography variant=\"body2\" sx={{ mb: 1 }}>\n              â„¹ï¸ No further action is needed\n            </Typography>\n            <Typography variant=\"body2\">\n              âœ‰ï¸ Contact support if you need to update your information\n            </Typography>\n          </Box>\n          <Typography variant=\"caption\" color=\"text.secondary\" sx={{ mt: 2, display: \"block\" }}>\n            You can close this window now.\n          </Typography>\n        </Paper>\n      </Box>\n    );\n  // âœ… Deferred screen (auto-close + message)\n  if (status === \"deferred\")\n    return (\n      <Box\n        sx={{\n          minHeight: \"100vh\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          bgcolor: \"#f8f9fa\",\n          textAlign: \"center\",\n          p: 3,\n        }}\n      >\n        <Paper\n          sx={{\n            p: 4,\n            borderRadius: 3,\n            border: \"1px solid #ddd\",\n            boxShadow: 3,\n            maxWidth: 480,\n          }}\n        >\n          <Typography variant=\"h5\" color=\"warning.main\" gutterBottom>\n            âš ï¸ Form Deferred\n          </Typography>\n          <Typography variant=\"body1\" sx={{ mb: 1 }}>\n            Youâ€™ve chosen to defer filling this form.\n          </Typography>\n          <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\n            You can complete it later using the reminder email link weâ€™ll send\n            soon.\n          </Typography>\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            This window will close automatically in <b>{countdown}</b> seconds.\n          </Typography>\n        </Paper>\n      </Box>\n    );\n\n  // âœ… Main Form UI\n  return (\n    <Box\n      sx={{\n        minHeight: \"100vh\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        bgcolor: \"#f8f9fa\",\n        p: 2,\n        flex: 1,\n        width: \"100%\",\n      }}\n    >\n      <Paper\n        sx={{\n          width: \"100%\",\n          maxWidth: 480,\n          p: 4,\n          borderRadius: 3,\n          boxShadow: 4,\n          border: \"1px solid #ddd\",\n          opacity: fadeOut ? 0 : 1,\n          transition: \"opacity 0.6s ease-in-out\",\n        }}\n      >\n        <Stack alignItems=\"center\" spacing={1}>\n          <Stack direction=\"row\" spacing={1} alignItems=\"center\">\n            <img src={logo1} alt=\"Logo1\" style={{ width: 45, height: 45 }} />\n            <img src={logo2} alt=\"Logo2\" style={{ width: 45, height: 45 }} />\n          </Stack>\n          <Typography variant=\"h6\" fontWeight=\"bold\">\n            Update Your Information\n          </Typography>\n          \n          {/* Countdown Timer */}\n          <Box\n            sx={{\n              width: \"100%\",\n              mt: 1,\n              p: 1.5,\n              borderRadius: 2,\n              backgroundColor: timeRemaining <= 120 ? \"#ffebee\" : timeRemaining <= 300 ? \"#fff3e0\" : \"#e3f2fd\",\n              border: `2px solid ${timeRemaining <= 120 ? \"#d32f2f\" : timeRemaining <= 300 ? \"#f57c00\" : \"#1976d2\"}`,\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              gap: 1,\n            }}\n          >\n            <Typography\n              sx={{\n                fontSize: \"1.1rem\",\n                fontWeight: \"bold\",\n                color: timeRemaining <= 120 ? \"#d32f2f\" : timeRemaining <= 300 ? \"#f57c00\" : \"#1976d2\",\n              }}\n            >\n              â±ï¸ Time Remaining: {Math.floor(timeRemaining / 60)}:{String(timeRemaining % 60).padStart(2, \"0\")}\n            </Typography>\n          </Box>\n          <Typography\n            variant=\"caption\"\n            sx={{\n              color: timeRemaining <= 120 ? \"#d32f2f\" : \"text.secondary\",\n              fontWeight: timeRemaining <= 120 ? \"bold\" : \"normal\",\n            }}\n          >\n            {timeRemaining <= 120\n              ? \"âš ï¸ Hurry! Your session will expire soon!\"\n              : \"Complete the form within 10 minutes or it will expire\"}\n          </Typography>\n          \n          <Divider sx={{ width: \"100%\", my: 1 }} />\n        </Stack>\n\n        {/* Opt-in/out */}\n        <FormControl fullWidth size=\"small\" sx={{ mt: 2 }}>\n          <InputLabel>Continue as part of our organization?</InputLabel>\n          <Select\n            value={interested ?? \"\"}\n            label=\"Continue?\"\n            onChange={(e) => setInterested(e.target.value)}\n          >\n            <MenuItem value=\"yes\">Yes, I want to continue</MenuItem>\n            <MenuItem value=\"no\">No, I want to opt out</MenuItem>\n          </Select>\n        </FormControl>\n\n        {interested === \"no\" ? (\n          <Box mt={3}>\n            <Typography variant=\"body2\">\n              We're sorry to see you go. You may share feedback (optional):\n            </Typography>\n            <TextField\n              fullWidth\n              multiline\n              rows={3}\n              placeholder=\"Your reason...\"\n              value={optoutReason}\n              onChange={(e) => setOptoutReason(e.target.value)}\n              sx={{ mt: 1 }}\n            />\n            <Button\n              fullWidth\n              variant=\"contained\"\n              color=\"error\"\n              sx={{ mt: 2, borderRadius: \"20px\" }}\n              onClick={handleOptOut}\n              disabled={optoutProcessing}\n            >\n              {optoutProcessing ? \"Processing...\" : \"Confirm Opt-Out\"}\n            </Button>\n          </Box>\n        ) : (\n          <Box component=\"form\" onSubmit={handleSubmit} mt={2}>\n            {/* Full Name */}\n            <TextField\n              label=\"Full Name *\"\n              fullWidth\n              size=\"small\"\n              margin=\"dense\"\n              name=\"fullName\"\n              value={formData.fullName}\n              onChange={handleChange}\n              required\n            />\n\n            {/* Phone */}\n            <TextField\n              label=\"Phone *\"\n              fullWidth\n              size=\"small\"\n              margin=\"dense\"\n              name=\"phone\"\n              value={formData.phone}\n              onChange={handleChange}\n              disabled={phoneVerification.isVerified}\n              required\n            />\n\n            {/* Email */}\n            <TextField\n              label=\"Email *\"\n              fullWidth\n              size=\"small\"\n              margin=\"dense\"\n              name=\"email\"\n              value={formData.email}\n              onChange={handleChange}\n              required\n            />\n\n            {/* Gender */}\n            <FormControl fullWidth size=\"small\" margin=\"dense\" required>\n              <InputLabel>Gender *</InputLabel>\n              <Select\n                value={formData.gender}\n                label=\"Gender *\"\n                onChange={handleChange}\n                name=\"gender\"\n              >\n                {GENDERS.map((g) => (\n                  <MenuItem key={g} value={g}>\n                    {g}\n                  </MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n\n            {/* Organisation */}\n            <Autocomplete\n              disablePortal\n              options={ORGANIZATIONS}\n              value={formData.organisation || (showCustomOrg ? \"Other\" : \"\")}\n              onChange={(e, newValue) => handleOrgChange(e, newValue)}\n              renderInput={(params) => (\n                <TextField\n                  {...params}\n                  label=\"Organisation *\"\n                  size=\"small\"\n                  margin=\"dense\"\n                  required\n                />\n              )}\n              sx={{ width: \"100%\" }}\n            />\n\n            {/* Custom Organisation Input (shown when \"Other\" is selected) */}\n            {showCustomOrg && (\n              <TextField\n                label=\"Enter Custom Organisation *\"\n                fullWidth\n                size=\"small\"\n                margin=\"dense\"\n                required\n                value={formData.organisation === \"Other\" ? \"\" : formData.organisation}\n                onChange={(e) => {\n                  isDirtyRef.current = true;\n                  setFormData({\n                    ...formData,\n                    organisation: e.target.value,\n                    orgType: \"\",\n                  });\n                }}\n              />\n            )}\n\n            {/* Organisation Type */}\n            {showCustomOrg ? (\n              <FormControl fullWidth size=\"small\" margin=\"dense\" required>\n                <InputLabel>Organisation Type</InputLabel>\n                <Select\n                  label=\"Organisation Type\"\n                  value={formData.orgType}\n                  onChange={(e) => {\n                    isDirtyRef.current = true;\n                    setFormData({ ...formData, orgType: e.target.value });\n                  }}\n                >\n                  <MenuItem value=\"Government\">Government</MenuItem>\n                  <MenuItem value=\"Corporate\">Corporate</MenuItem>\n                  <MenuItem value=\"Academic\">Academic</MenuItem>\n                  <MenuItem value=\"NGO\">NGO</MenuItem>\n                  <MenuItem value=\"Self\">Self</MenuItem>\n                </Select>\n              </FormControl>\n            ) : (\n              <TextField\n                label=\"Organisation Type\"\n                fullWidth\n                size=\"small\"\n                margin=\"dense\"\n                value={formData.orgType}\n                InputProps={{ readOnly: true }}\n              />\n            )}\n\n            {/* Role */}\n            <FormControl fullWidth size=\"small\" margin=\"dense\" required>\n              <InputLabel>Role *</InputLabel>\n              <Select\n                value={formData.role}\n                label=\"Role *\"\n                name=\"role\"\n                onChange={(e) =>\n                  setFormData({ ...formData, role: e.target.value })\n                }\n              >\n                {ROLES.map((r) => (\n                  <MenuItem key={r.value} value={r.value}>\n                    {r.label}\n                  </MenuItem>\n                ))}\n              </Select>\n            </FormControl>\n\n            <Typography fontWeight=\"bold\" fontSize={14} mt={2} mb={1}>\n              Social:\n            </Typography>\n\n            {/* GitHub Section */}\n            <Typography fontWeight=\"bold\" fontSize={14} mt={1} mb={1}>\n              GitHub:\n            </Typography>\n            <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1, width: \"100%\", mt: 1 }}>\n              <Button\n                fullWidth\n                variant=\"contained\"\n                onClick={handleVerifyGithub}\n                disabled={githubStatus.verified || githubStatus.verifying}\n                sx={{\n                  borderRadius: \"10px\",\n                  fontWeight: \"bold\",\n                  backgroundColor: githubStatus.verified ? \"#4CAF50\" : \"#000\",\n                  color: \"white\",\n                  \"&:disabled\": {\n                    backgroundColor: githubStatus.verified ? \"#4CAF50\" : \"#9e9e9e\",\n                    color: \"white\",\n                  },\n                }}\n              >\n                {githubStatus.verified ? \"GitHub Verified âœ“\" : \"Verify GitHub\"}\n              </Button>\n\n              {githubStatus.verified && (\n                <Typography fontSize={13} color=\"#2e7d32\">\n                  âœ“ Verified as: {githubStatus.username}\n                </Typography>\n              )}\n\n              {!githubStatus.verified && githubStatus.error && (\n                <Typography fontSize={13} color=\"#d32f2f\">\n                  âŒ {githubStatus.error}\n                </Typography>\n              )}\n            </Box>\n\n            {/* Discord Section */}\n            <Typography fontWeight=\"bold\" fontSize={14} mt={2} mb={1}>\n              Discord:\n            </Typography>\n            <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1, width: \"100%\", mt: 1 }}>\n              {discordVerified ? (\n                <>\n                  <Button\n                    fullWidth\n                    variant=\"contained\"\n                    disabled\n                    sx={{\n                      borderRadius: \"10px\",\n                      fontWeight: \"bold\",\n                      backgroundColor: \"#4CAF50\",\n                      color: \"white\",\n                      \"&.Mui-disabled\": {\n                        backgroundColor: \"#4CAF50\",\n                        color: \"white\",\n                      },\n                    }}\n                  >\n                    DISCORD VERIFIED âœ“\n                  </Button>\n\n                  <Typography fontSize={13} color=\"#2e7d32\">\n                    âœ“ Verified as: {sessionStorage.getItem(\"discordUsername\")}\n                  </Typography>\n                </>\n              ) : (\n                <>\n                  <Button\n                    fullWidth\n                    variant=\"contained\"\n                    sx={{\n                      borderRadius: \"10px\",\n                      fontWeight: \"bold\",\n                      backgroundColor: \"#1E4DD8\",\n                      \"&:hover\": { backgroundColor: \"#1536A1\" },\n                    }}\n                    onClick={handleVerifyDiscord}\n                    disabled={discordStatus.verifying}\n                    startIcon={discordStatus.verifying ? <CircularProgress size={20} color=\"inherit\" /> : null}\n                  >\n                    {discordStatus.verifying ? \"REDIRECTING...\" : \"VERIFY DISCORD\"}\n                  </Button>\n\n                  {discordNotMember && (\n                    <>\n                      <Button\n                        fullWidth\n                        variant=\"outlined\"\n                        sx={{ borderRadius: \"10px\", fontWeight: \"bold\" }}\n                        onClick={() => window.open(DISCORD_INVITE, \"_blank\")}\n                      >\n                        JOIN DISCORD SERVER\n                      </Button>\n                      <Typography fontSize={13} color=\"#d32f2f\">\n                        âŒ You must join our Discord server before verification.\n                      </Typography>\n                    </>\n                  )}\n                </>\n              )}\n            </Box>\n\n            {/* LinkedIn Section */}\n            <Typography fontWeight=\"bold\" fontSize={14} mt={2} mb={1}>\n              LinkedIn URL (Optional):\n            </Typography>\n            <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1, width: \"100%\", mt: 1 }}>\n              <TextField\n                label=\"Enter LinkedIn profile URL\"\n                placeholder=\"https://www.linkedin.com/in/username\"\n                value={formData.linkedinId}\n                onChange={(e) => setFormData({ ...formData, linkedinId: e.target.value })}\n                size=\"small\"\n                fullWidth\n              />\n            </Box>\n\n            {/* OTP Section */}\n            <Box mt={2}>\n              <div id=\"recaptcha-container-update\"></div>\n              {!phoneVerification.isVerified && (\n                <Stack direction=\"row\" spacing={2} mt={1}>\n                  <Button\n                    variant=\"outlined\"\n                    fullWidth\n                    onClick={handleRequestOtp}\n                    disabled={phoneVerification.isProcessing || timer > 0}\n                  >\n                    {timer > 0\n                      ? `Resend in ${timer}s`\n                      : phoneVerification.isProcessing\n                      ? \"Sending...\"\n                      : phoneVerification.showOtpInput\n                      ? \"Resend OTP\"\n                      : \"Send OTP\"}\n                  </Button>\n                  {phoneVerification.showOtpInput && (\n                    <TextField\n                      label=\"Enter 6-digit OTP\"\n                      size=\"small\"\n                      value={phoneVerification.otp}\n                      onChange={(e) => {\n                        const onlyNums = e.target.value.replace(/\\D/g, \"\");\n                        if (onlyNums.length <= 6)\n                          setPhoneVerification({\n                            ...phoneVerification,\n                            otp: onlyNums,\n                          });\n                      }}\n                      inputProps={{\n                        inputMode: \"numeric\",\n                        pattern: \"[0-9]*\",\n                        maxLength: 6,\n                        onKeyPress: (e) => {\n                          if (!/[0-9]/.test(e.key)) e.preventDefault();\n                        },\n                      }}\n                    />\n                  )}\n                  {phoneVerification.showOtpInput && (\n                    <Button\n                      variant=\"contained\"\n                      color=\"primary\"\n                      onClick={handleVerifyOtp}\n                      disabled={phoneVerification.isProcessing}\n                    >\n                      {phoneVerification.isProcessing ? (\n                        <CircularProgress size={18} color=\"inherit\" />\n                      ) : (\n                        \"Verify\"\n                      )}\n                    </Button>\n                  )}\n                </Stack>\n              )}\n              {phoneVerification.isVerified && (\n                <Typography color=\"success.main\" mt={1}>\n                  âœ… Phone verified successfully!\n                </Typography>\n              )}\n            </Box>\n\n            {/* Actions */}\n            <Stack direction=\"row\" spacing={2} mt={3}>\n              <Button\n                type=\"submit\"\n                variant=\"contained\"\n                color=\"primary\"\n                fullWidth\n                disabled={!isFormComplete()}\n              >\n                Submit\n              </Button>\n              <Button \n                variant=\"outlined\" \n                fullWidth \n                onClick={handleDefer}\n                disabled={oauthInProgress}\n              >\n                Defer\n              </Button>\n            </Stack>\n          </Box>\n        )}\n      </Paper>\n    </Box>\n  );\n};\n\nexport default UpdateForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}