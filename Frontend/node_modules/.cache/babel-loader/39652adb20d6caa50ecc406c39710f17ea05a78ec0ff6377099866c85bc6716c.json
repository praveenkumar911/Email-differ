{"ast":null,"code":"import _defineProperty from \"/home/rcts/Email-differ/Frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport { RpcProtocol } from \"@smithy/core/protocols\";\nimport { deref, NormalizedSchema, TypeRegistry } from \"@smithy/core/schema\";\nimport { getSmithyContext } from \"@smithy/util-middleware\";\nimport { CborCodec } from \"./CborCodec\";\nimport { loadSmithyRpcV2CborErrorCode } from \"./parseCborBody\";\nexport class SmithyRpcV2CborProtocol extends RpcProtocol {\n  constructor(_ref) {\n    let {\n      defaultNamespace\n    } = _ref;\n    super({\n      defaultNamespace\n    });\n    _defineProperty(this, \"codec\", new CborCodec());\n    _defineProperty(this, \"serializer\", this.codec.createSerializer());\n    _defineProperty(this, \"deserializer\", this.codec.createDeserializer());\n  }\n  getShapeId() {\n    return \"smithy.protocols#rpcv2Cbor\";\n  }\n  getPayloadCodec() {\n    return this.codec;\n  }\n  async serializeRequest(operationSchema, input, context) {\n    const request = await super.serializeRequest(operationSchema, input, context);\n    Object.assign(request.headers, {\n      \"content-type\": this.getDefaultContentType(),\n      \"smithy-protocol\": \"rpc-v2-cbor\",\n      accept: this.getDefaultContentType()\n    });\n    if (deref(operationSchema.input) === \"unit\") {\n      delete request.body;\n      delete request.headers[\"content-type\"];\n    } else {\n      if (!request.body) {\n        this.serializer.write(15, {});\n        request.body = this.serializer.flush();\n      }\n      try {\n        request.headers[\"content-length\"] = String(request.body.byteLength);\n      } catch (e) {}\n    }\n    const {\n      service,\n      operation\n    } = getSmithyContext(context);\n    const path = \"/service/\".concat(service, \"/operation/\").concat(operation);\n    if (request.path.endsWith(\"/\")) {\n      request.path += path.slice(1);\n    } else {\n      request.path += path;\n    }\n    return request;\n  }\n  async deserializeResponse(operationSchema, context, response) {\n    return super.deserializeResponse(operationSchema, context, response);\n  }\n  async handleError(operationSchema, context, response, dataObject, metadata) {\n    var _loadSmithyRpcV2CborE, _ref2, _dataObject$message;\n    const errorName = (_loadSmithyRpcV2CborE = loadSmithyRpcV2CborErrorCode(response, dataObject)) !== null && _loadSmithyRpcV2CborE !== void 0 ? _loadSmithyRpcV2CborE : \"Unknown\";\n    let namespace = this.options.defaultNamespace;\n    if (errorName.includes(\"#\")) {\n      [namespace] = errorName.split(\"#\");\n    }\n    const errorMetadata = {\n      $metadata: metadata,\n      $fault: response.statusCode <= 500 ? \"client\" : \"server\"\n    };\n    const registry = TypeRegistry.for(namespace);\n    let errorSchema;\n    try {\n      errorSchema = registry.getSchema(errorName);\n    } catch (e) {\n      if (dataObject.Message) {\n        dataObject.message = dataObject.Message;\n      }\n      const synthetic = TypeRegistry.for(\"smithy.ts.sdk.synthetic.\" + namespace);\n      const baseExceptionSchema = synthetic.getBaseException();\n      if (baseExceptionSchema) {\n        const ErrorCtor = synthetic.getErrorCtor(baseExceptionSchema);\n        throw Object.assign(new ErrorCtor({\n          name: errorName\n        }), errorMetadata, dataObject);\n      }\n      throw Object.assign(new Error(errorName), errorMetadata, dataObject);\n    }\n    const ns = NormalizedSchema.of(errorSchema);\n    const ErrorCtor = registry.getErrorCtor(errorSchema);\n    const message = (_ref2 = (_dataObject$message = dataObject.message) !== null && _dataObject$message !== void 0 ? _dataObject$message : dataObject.Message) !== null && _ref2 !== void 0 ? _ref2 : \"Unknown\";\n    const exception = new ErrorCtor(message);\n    const output = {};\n    for (const [name, member] of ns.structIterator()) {\n      output[name] = this.deserializer.readValue(member, dataObject[name]);\n    }\n    throw Object.assign(exception, errorMetadata, {\n      $fault: ns.getMergedTraits().error,\n      message\n    }, output);\n  }\n  getDefaultContentType() {\n    return \"application/cbor\";\n  }\n}","map":{"version":3,"names":["RpcProtocol","deref","NormalizedSchema","TypeRegistry","getSmithyContext","CborCodec","loadSmithyRpcV2CborErrorCode","SmithyRpcV2CborProtocol","constructor","_ref","defaultNamespace","_defineProperty","codec","createSerializer","createDeserializer","getShapeId","getPayloadCodec","serializeRequest","operationSchema","input","context","request","Object","assign","headers","getDefaultContentType","accept","body","serializer","write","flush","String","byteLength","e","service","operation","path","concat","endsWith","slice","deserializeResponse","response","handleError","dataObject","metadata","_loadSmithyRpcV2CborE","_ref2","_dataObject$message","errorName","namespace","options","includes","split","errorMetadata","$metadata","$fault","statusCode","registry","for","errorSchema","getSchema","Message","message","synthetic","baseExceptionSchema","getBaseException","ErrorCtor","getErrorCtor","name","Error","ns","of","exception","output","member","structIterator","deserializer","readValue","getMergedTraits","error"],"sources":["/home/rcts/Email-differ/Frontend/node_modules/@smithy/core/dist-es/submodules/cbor/SmithyRpcV2CborProtocol.js"],"sourcesContent":["import { RpcProtocol } from \"@smithy/core/protocols\";\nimport { deref, NormalizedSchema, TypeRegistry } from \"@smithy/core/schema\";\nimport { getSmithyContext } from \"@smithy/util-middleware\";\nimport { CborCodec } from \"./CborCodec\";\nimport { loadSmithyRpcV2CborErrorCode } from \"./parseCborBody\";\nexport class SmithyRpcV2CborProtocol extends RpcProtocol {\n    codec = new CborCodec();\n    serializer = this.codec.createSerializer();\n    deserializer = this.codec.createDeserializer();\n    constructor({ defaultNamespace }) {\n        super({ defaultNamespace });\n    }\n    getShapeId() {\n        return \"smithy.protocols#rpcv2Cbor\";\n    }\n    getPayloadCodec() {\n        return this.codec;\n    }\n    async serializeRequest(operationSchema, input, context) {\n        const request = await super.serializeRequest(operationSchema, input, context);\n        Object.assign(request.headers, {\n            \"content-type\": this.getDefaultContentType(),\n            \"smithy-protocol\": \"rpc-v2-cbor\",\n            accept: this.getDefaultContentType(),\n        });\n        if (deref(operationSchema.input) === \"unit\") {\n            delete request.body;\n            delete request.headers[\"content-type\"];\n        }\n        else {\n            if (!request.body) {\n                this.serializer.write(15, {});\n                request.body = this.serializer.flush();\n            }\n            try {\n                request.headers[\"content-length\"] = String(request.body.byteLength);\n            }\n            catch (e) { }\n        }\n        const { service, operation } = getSmithyContext(context);\n        const path = `/service/${service}/operation/${operation}`;\n        if (request.path.endsWith(\"/\")) {\n            request.path += path.slice(1);\n        }\n        else {\n            request.path += path;\n        }\n        return request;\n    }\n    async deserializeResponse(operationSchema, context, response) {\n        return super.deserializeResponse(operationSchema, context, response);\n    }\n    async handleError(operationSchema, context, response, dataObject, metadata) {\n        const errorName = loadSmithyRpcV2CborErrorCode(response, dataObject) ?? \"Unknown\";\n        let namespace = this.options.defaultNamespace;\n        if (errorName.includes(\"#\")) {\n            [namespace] = errorName.split(\"#\");\n        }\n        const errorMetadata = {\n            $metadata: metadata,\n            $fault: response.statusCode <= 500 ? \"client\" : \"server\",\n        };\n        const registry = TypeRegistry.for(namespace);\n        let errorSchema;\n        try {\n            errorSchema = registry.getSchema(errorName);\n        }\n        catch (e) {\n            if (dataObject.Message) {\n                dataObject.message = dataObject.Message;\n            }\n            const synthetic = TypeRegistry.for(\"smithy.ts.sdk.synthetic.\" + namespace);\n            const baseExceptionSchema = synthetic.getBaseException();\n            if (baseExceptionSchema) {\n                const ErrorCtor = synthetic.getErrorCtor(baseExceptionSchema);\n                throw Object.assign(new ErrorCtor({ name: errorName }), errorMetadata, dataObject);\n            }\n            throw Object.assign(new Error(errorName), errorMetadata, dataObject);\n        }\n        const ns = NormalizedSchema.of(errorSchema);\n        const ErrorCtor = registry.getErrorCtor(errorSchema);\n        const message = dataObject.message ?? dataObject.Message ?? \"Unknown\";\n        const exception = new ErrorCtor(message);\n        const output = {};\n        for (const [name, member] of ns.structIterator()) {\n            output[name] = this.deserializer.readValue(member, dataObject[name]);\n        }\n        throw Object.assign(exception, errorMetadata, {\n            $fault: ns.getMergedTraits().error,\n            message,\n        }, output);\n    }\n    getDefaultContentType() {\n        return \"application/cbor\";\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}