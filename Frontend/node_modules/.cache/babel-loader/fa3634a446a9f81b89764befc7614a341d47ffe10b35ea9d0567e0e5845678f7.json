{"ast":null,"code":"import{S3Client,PutObjectCommand}from\"@aws-sdk/client-s3\";const MINIO_ENDPOINT=\"https://pl-minio.iiit.ac.in\";const REGION=\"us-east-1\";const ACCESS_KEY=\"minioadmin\";const SECRET_KEY=\"minioadmin\";const BUCKET_NAME=\"org-c4gt\";const s3=new S3Client({region:REGION,endpoint:MINIO_ENDPOINT,credentials:{accessKeyId:ACCESS_KEY,secretAccessKey:SECRET_KEY},forcePathStyle:true,requestChecksumCalculation:\"WHEN_REQUIRED\"});export async function uploadImageToMinio(file){let customName=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"\";if(!file){console.log(\" No file provided\");return null;}try{const extension=file.name.split(\".\").pop();const timestamp=new Date().toISOString().replace(/[:.]/g,\"-\");const fileName=\"\".concat(customName,\"_\").concat(timestamp,\".\").concat(extension);const arrayBuffer=await file.arrayBuffer();const fileBytes=new Uint8Array(arrayBuffer);const uploadParams={Bucket:BUCKET_NAME,Key:fileName,Body:fileBytes,ContentType:file.type,ContentLength:fileBytes.length};const command=new PutObjectCommand(uploadParams);await s3.send(command);const imageUrl=\"\".concat(MINIO_ENDPOINT,\"/\").concat(BUCKET_NAME,\"/\").concat(fileName);console.log(\"Uploaded successfully:\",imageUrl);return imageUrl;}catch(err){console.error(\" Upload failed:\",err);throw err;}}","map":{"version":3,"names":["S3Client","PutObjectCommand","MINIO_ENDPOINT","REGION","ACCESS_KEY","SECRET_KEY","BUCKET_NAME","s3","region","endpoint","credentials","accessKeyId","secretAccessKey","forcePathStyle","requestChecksumCalculation","uploadImageToMinio","file","customName","arguments","length","undefined","console","log","extension","name","split","pop","timestamp","Date","toISOString","replace","fileName","concat","arrayBuffer","fileBytes","Uint8Array","uploadParams","Bucket","Key","Body","ContentType","type","ContentLength","command","send","imageUrl","err","error"],"sources":["/home/rcts/Email-differ/Frontend/src/utils/minioUpload.js"],"sourcesContent":["import { S3Client, PutObjectCommand } from \"@aws-sdk/client-s3\";\r\n\r\nconst MINIO_ENDPOINT = \"https://pl-minio.iiit.ac.in\";\r\nconst REGION = \"us-east-1\";\r\nconst ACCESS_KEY = \"minioadmin\";\r\nconst SECRET_KEY = \"minioadmin\";\r\nconst BUCKET_NAME = \"org-c4gt\";\r\n\r\nconst s3 = new S3Client({\r\n  region: REGION,\r\n  endpoint: MINIO_ENDPOINT,\r\n  credentials: {\r\n    accessKeyId: ACCESS_KEY,\r\n    secretAccessKey: SECRET_KEY,\r\n  },\r\n  forcePathStyle: true,\r\n\r\n  requestChecksumCalculation: \"WHEN_REQUIRED\",\r\n});\r\n\r\nexport async function uploadImageToMinio(file, customName = \"\") {\r\n  if (!file) {\r\n    console.log(\" No file provided\");\r\n    return null;\r\n  }\r\n\r\n  try {\r\n    const extension = file.name.split(\".\").pop();\r\n    const timestamp = new Date().toISOString().replace(/[:.]/g, \"-\");\r\n    const fileName = `${customName}_${timestamp}.${extension}`;\r\n\r\n    const arrayBuffer = await file.arrayBuffer();\r\n    const fileBytes = new Uint8Array(arrayBuffer);\r\n\r\n    const uploadParams = {\r\n      Bucket: BUCKET_NAME,\r\n      Key: fileName,\r\n      Body: fileBytes,\r\n      ContentType: file.type,\r\n      ContentLength: fileBytes.length,\r\n    };\r\n\r\n    const command = new PutObjectCommand(uploadParams);\r\n    await s3.send(command);\r\n\r\n    const imageUrl = `${MINIO_ENDPOINT}/${BUCKET_NAME}/${fileName}`;\r\n    console.log(\"Uploaded successfully:\", imageUrl);\r\n\r\n    return imageUrl;\r\n  } catch (err) {\r\n    console.error(\" Upload failed:\", err);\r\n    throw err;\r\n  }\r\n}\r\n"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,gBAAgB,KAAQ,oBAAoB,CAE/D,KAAM,CAAAC,cAAc,CAAG,6BAA6B,CACpD,KAAM,CAAAC,MAAM,CAAG,WAAW,CAC1B,KAAM,CAAAC,UAAU,CAAG,YAAY,CAC/B,KAAM,CAAAC,UAAU,CAAG,YAAY,CAC/B,KAAM,CAAAC,WAAW,CAAG,UAAU,CAE9B,KAAM,CAAAC,EAAE,CAAG,GAAI,CAAAP,QAAQ,CAAC,CACtBQ,MAAM,CAAEL,MAAM,CACdM,QAAQ,CAAEP,cAAc,CACxBQ,WAAW,CAAE,CACXC,WAAW,CAAEP,UAAU,CACvBQ,eAAe,CAAEP,UACnB,CAAC,CACDQ,cAAc,CAAE,IAAI,CAEpBC,0BAA0B,CAAE,eAC9B,CAAC,CAAC,CAEF,MAAO,eAAe,CAAAC,kBAAkBA,CAACC,IAAI,CAAmB,IAAjB,CAAAC,UAAU,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,EAAE,CAC5D,GAAI,CAACF,IAAI,CAAE,CACTK,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC,CAChC,MAAO,KAAI,CACb,CAEA,GAAI,CACF,KAAM,CAAAC,SAAS,CAAGP,IAAI,CAACQ,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,CAAC,CAAC,CAC5C,KAAM,CAAAC,SAAS,CAAG,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,OAAO,CAAC,OAAO,CAAE,GAAG,CAAC,CAChE,KAAM,CAAAC,QAAQ,IAAAC,MAAA,CAAMf,UAAU,MAAAe,MAAA,CAAIL,SAAS,MAAAK,MAAA,CAAIT,SAAS,CAAE,CAE1D,KAAM,CAAAU,WAAW,CAAG,KAAM,CAAAjB,IAAI,CAACiB,WAAW,CAAC,CAAC,CAC5C,KAAM,CAAAC,SAAS,CAAG,GAAI,CAAAC,UAAU,CAACF,WAAW,CAAC,CAE7C,KAAM,CAAAG,YAAY,CAAG,CACnBC,MAAM,CAAE/B,WAAW,CACnBgC,GAAG,CAAEP,QAAQ,CACbQ,IAAI,CAAEL,SAAS,CACfM,WAAW,CAAExB,IAAI,CAACyB,IAAI,CACtBC,aAAa,CAAER,SAAS,CAACf,MAC3B,CAAC,CAED,KAAM,CAAAwB,OAAO,CAAG,GAAI,CAAA1C,gBAAgB,CAACmC,YAAY,CAAC,CAClD,KAAM,CAAA7B,EAAE,CAACqC,IAAI,CAACD,OAAO,CAAC,CAEtB,KAAM,CAAAE,QAAQ,IAAAb,MAAA,CAAM9B,cAAc,MAAA8B,MAAA,CAAI1B,WAAW,MAAA0B,MAAA,CAAID,QAAQ,CAAE,CAC/DV,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAEuB,QAAQ,CAAC,CAE/C,MAAO,CAAAA,QAAQ,CACjB,CAAE,MAAOC,GAAG,CAAE,CACZzB,OAAO,CAAC0B,KAAK,CAAC,iBAAiB,CAAED,GAAG,CAAC,CACrC,KAAM,CAAAA,GAAG,CACX,CACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}